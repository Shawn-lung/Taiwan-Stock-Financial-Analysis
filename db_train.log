2025-04-06 15:13:27,602 - __main__ - INFO - Starting comprehensive model training
2025-04-06 15:13:27,604 - __main__ - WARNING - No GPU found, using CPU instead
2025-04-06 15:13:27,604 - __main__ - INFO - Using default configuration
2025-04-06 15:13:27,605 - __main__ - INFO - Starting comprehensive model training at 2025-04-06 15:13:27.605080
2025-04-06 15:13:27,608 - __main__ - INFO - Found 34 industries in database
2025-04-06 15:13:27,608 - __main__ - INFO - Found 34 industries with at least 5 stocks
2025-04-06 15:13:27,608 - __main__ - INFO - Processing industry 1/34: Electronics
2025-04-06 15:13:27,609 - __main__ - INFO - Found 452 stocks in Electronics industry
2025-04-06 15:13:38,569 - __main__ - INFO - Saved 6885 records for Electronics to industry_data_from_db\electronics_training.csv
2025-04-06 15:13:39,265 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:13:39,266 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:13:39,266 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:13:39,267 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:13:39,335 - __main__ - ERROR - Error training model for Electronics: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\electronics_checkpoint
2025-04-06 15:13:39,346 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\electronics_checkpoint

2025-04-06 15:13:39,346 - __main__ - WARNING - Failed to train model for Electronics
2025-04-06 15:13:39,346 - __main__ - INFO - Processing industry 2/34: Healthcare
2025-04-06 15:13:39,348 - __main__ - INFO - Found 280 stocks in Healthcare industry
2025-04-06 15:13:45,640 - __main__ - INFO - Saved 3663 records for Healthcare to industry_data_from_db\healthcare_training.csv
2025-04-06 15:13:51,659 - __main__ - INFO - Training model for Healthcare with 3663 records
2025-04-06 15:13:51,659 - __main__ - INFO - Training model for Healthcare with 3663 records
2025-04-06 15:13:51,660 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:13:51,660 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:13:51,663 - __main__ - ERROR - Error training model for Healthcare: Input X contains infinity or a value too large for dtype('float64').
2025-04-06 15:13:51,702 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 534, in train_industry_model
    X_train_scaled = scaler.fit_transform(X_train)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 918, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\preprocessing\_data.py", line 1624, in fit
    X = validate_data(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 1107, in check_array
    _assert_all_finite(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains infinity or a value too large for dtype('float64').

2025-04-06 15:13:51,702 - __main__ - WARNING - Failed to train model for Healthcare
2025-04-06 15:13:51,702 - __main__ - INFO - Processing industry 3/34: Electronics Manufacturing
2025-04-06 15:13:51,704 - __main__ - INFO - Found 246 stocks in Electronics Manufacturing industry
2025-04-06 15:13:58,947 - __main__ - INFO - Saved 4215 records for Electronics Manufacturing to industry_data_from_db\electronics_manufacturing_training.csv
2025-04-06 15:14:04,245 - __main__ - INFO - Training model for Electronics Manufacturing with 4215 records
2025-04-06 15:14:04,246 - __main__ - INFO - Training model for Electronics Manufacturing with 4215 records
2025-04-06 15:14:04,246 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:04,246 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:04,249 - __main__ - ERROR - Error training model for Electronics Manufacturing: Input X contains infinity or a value too large for dtype('float64').
2025-04-06 15:14:04,250 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 534, in train_industry_model
    X_train_scaled = scaler.fit_transform(X_train)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 918, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\preprocessing\_data.py", line 1624, in fit
    X = validate_data(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 1107, in check_array
    _assert_all_finite(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains infinity or a value too large for dtype('float64').

2025-04-06 15:14:04,250 - __main__ - WARNING - Failed to train model for Electronics Manufacturing
2025-04-06 15:14:04,250 - __main__ - INFO - Processing industry 4/34: Other
2025-04-06 15:14:04,252 - __main__ - INFO - Found 222 stocks in Other industry
2025-04-06 15:14:07,299 - __main__ - INFO - Saved 1637 records for Other to industry_data_from_db\other_training.csv
2025-04-06 15:14:08,399 - __main__ - INFO - Training model for Other with 1637 records
2025-04-06 15:14:08,399 - __main__ - INFO - Training model for Other with 1637 records
2025-04-06 15:14:08,400 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:08,400 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:08,403 - __main__ - ERROR - Error training model for Other: Input X contains infinity or a value too large for dtype('float64').
2025-04-06 15:14:08,403 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 534, in train_industry_model
    X_train_scaled = scaler.fit_transform(X_train)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 918, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\preprocessing\_data.py", line 1624, in fit
    X = validate_data(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 1107, in check_array
    _assert_all_finite(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains infinity or a value too large for dtype('float64').

2025-04-06 15:14:08,403 - __main__ - WARNING - Failed to train model for Other
2025-04-06 15:14:08,404 - __main__ - INFO - Processing industry 5/34: Computer Hardware
2025-04-06 15:14:08,405 - __main__ - INFO - Found 137 stocks in Computer Hardware industry
2025-04-06 15:14:12,870 - __main__ - INFO - Saved 2213 records for Computer Hardware to industry_data_from_db\computer_hardware_training.csv
2025-04-06 15:14:13,401 - __main__ - INFO - Training model for Computer Hardware with 2213 records
2025-04-06 15:14:13,401 - __main__ - INFO - Training model for Computer Hardware with 2213 records
2025-04-06 15:14:13,401 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:13,401 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:13,424 - __main__ - ERROR - Error training model for Computer Hardware: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\computer_hardware_checkpoint
2025-04-06 15:14:13,424 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\computer_hardware_checkpoint

2025-04-06 15:14:13,424 - __main__ - WARNING - Failed to train model for Computer Hardware
2025-04-06 15:14:13,424 - __main__ - INFO - Processing industry 6/34: Industrial Equipment
2025-04-06 15:14:13,425 - __main__ - INFO - Found 126 stocks in Industrial Equipment industry
2025-04-06 15:14:16,885 - __main__ - INFO - Saved 2032 records for Industrial Equipment to industry_data_from_db\industrial_equipment_training.csv
2025-04-06 15:14:17,381 - __main__ - INFO - Training model for Industrial Equipment with 2032 records
2025-04-06 15:14:17,381 - __main__ - INFO - Training model for Industrial Equipment with 2032 records
2025-04-06 15:14:17,383 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:17,383 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:17,404 - __main__ - ERROR - Error training model for Industrial Equipment: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\industrial_equipment_checkpoint
2025-04-06 15:14:17,404 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\industrial_equipment_checkpoint

2025-04-06 15:14:17,405 - __main__ - WARNING - Failed to train model for Industrial Equipment
2025-04-06 15:14:17,405 - __main__ - INFO - Processing industry 7/34: Semiconductors
2025-04-06 15:14:17,406 - __main__ - INFO - Found 125 stocks in Semiconductors industry
2025-04-06 15:14:20,684 - __main__ - INFO - Saved 1905 records for Semiconductors to industry_data_from_db\semiconductors_training.csv
2025-04-06 15:14:21,625 - __main__ - INFO - Training model for Semiconductors with 1905 records
2025-04-06 15:14:21,625 - __main__ - INFO - Training model for Semiconductors with 1905 records
2025-04-06 15:14:21,626 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:21,626 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:21,649 - __main__ - ERROR - Error training model for Semiconductors: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\semiconductors_checkpoint
2025-04-06 15:14:21,649 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\semiconductors_checkpoint

2025-04-06 15:14:21,650 - __main__ - WARNING - Failed to train model for Semiconductors
2025-04-06 15:14:21,650 - __main__ - INFO - Processing industry 8/34: Financial Services
2025-04-06 15:14:21,651 - __main__ - INFO - Found 82 stocks in Financial Services industry
2025-04-06 15:14:23,286 - __main__ - INFO - Saved 204 records for Financial Services to industry_data_from_db\financial_services_training.csv
2025-04-06 15:14:23,768 - __main__ - INFO - Training model for Financial Services with 204 records
2025-04-06 15:14:23,769 - __main__ - INFO - Training model for Financial Services with 204 records
2025-04-06 15:14:23,769 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'revenue_growth']
2025-04-06 15:14:23,770 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:23,794 - __main__ - ERROR - Error training model for Financial Services: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\financial_services_checkpoint
2025-04-06 15:14:23,794 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\嚙踝蕭嚙穀GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\financial_services_checkpoint

2025-04-06 15:14:23,794 - __main__ - WARNING - Failed to train model for Financial Services
2025-04-06 15:14:23,794 - __main__ - INFO - Processing industry 9/34: Construction
2025-04-06 15:14:23,795 - __main__ - INFO - Found 80 stocks in Construction industry
2025-04-06 15:14:26,283 - __main__ - INFO - Saved 1462 records for Construction to industry_data_from_db\construction_training.csv
2025-04-06 15:14:51,068 - __main__ - INFO - Saved 626 records for Green Energy to industry_data_from_db\green_energy_training.csv
2025-04-06 15:14:51,599 - __main__ - INFO - Training model for Green Energy with 626 records
2025-04-06 15:14:51,599 - __main__ - INFO - Training model for Green Energy with 626 records
2025-04-06 15:14:51,600 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:51,600 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:51,623 - __main__ - ERROR - Error training model for Green Energy: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\green_energy_checkpoint
2025-04-06 15:14:51,623 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\green_energy_checkpoint

2025-04-06 15:14:51,624 - __main__ - WARNING - Failed to train model for Green Energy
2025-04-06 15:14:51,624 - __main__ - INFO - Processing industry 13/34: Telecommunications
2025-04-06 15:14:51,625 - __main__ - INFO - Found 55 stocks in Telecommunications industry
2025-04-06 15:14:53,786 - __main__ - INFO - Saved 970 records for Telecommunications to industry_data_from_db\telecommunications_training.csv
2025-04-06 15:14:54,311 - __main__ - INFO - Training model for Telecommunications with 970 records
2025-04-06 15:14:54,311 - __main__ - INFO - Training model for Telecommunications with 970 records
2025-04-06 15:14:54,312 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:54,312 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:54,332 - __main__ - ERROR - Error training model for Telecommunications: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\telecommunications_checkpoint
2025-04-06 15:14:54,332 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\telecommunications_checkpoint

2025-04-06 15:14:54,332 - __main__ - WARNING - Failed to train model for Telecommunications
2025-04-06 15:14:54,332 - __main__ - INFO - Processing industry 14/34: Steel & Metals
2025-04-06 15:14:54,333 - __main__ - INFO - Found 54 stocks in Steel & Metals industry
2025-04-06 15:14:55,797 - __main__ - INFO - Saved 930 records for Steel & Metals to industry_data_from_db\steel_&_metals_training.csv
2025-04-06 15:14:57,099 - __main__ - INFO - Training model for Steel & Metals with 930 records
2025-04-06 15:14:57,099 - __main__ - INFO - Training model for Steel & Metals with 930 records
2025-04-06 15:14:57,099 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:57,100 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:57,121 - __main__ - ERROR - Error training model for Steel & Metals: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\steel_&_metals_checkpoint
2025-04-06 15:14:57,121 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\steel_&_metals_checkpoint

2025-04-06 15:14:57,121 - __main__ - WARNING - Failed to train model for Steel & Metals
2025-04-06 15:14:57,122 - __main__ - INFO - Processing industry 15/34: Electronics Distribution
2025-04-06 15:14:57,123 - __main__ - INFO - Found 48 stocks in Electronics Distribution industry
2025-04-06 15:14:58,307 - __main__ - INFO - Saved 719 records for Electronics Distribution to industry_data_from_db\electronics_distribution_training.csv
2025-04-06 15:14:59,026 - __main__ - INFO - Training model for Electronics Distribution with 719 records
2025-04-06 15:14:59,026 - __main__ - INFO - Training model for Electronics Distribution with 719 records
2025-04-06 15:14:59,027 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:14:59,028 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:14:59,051 - __main__ - ERROR - Error training model for Electronics Distribution: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\electronics_distribution_checkpoint
2025-04-06 15:14:59,051 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\electronics_distribution_checkpoint

2025-04-06 15:14:59,051 - __main__ - WARNING - Failed to train model for Electronics Distribution
2025-04-06 15:14:59,052 - __main__ - INFO - Processing industry 16/34: Technology Services
2025-04-06 15:14:59,053 - __main__ - INFO - Found 46 stocks in Technology Services industry
2025-04-06 15:15:00,133 - __main__ - INFO - Saved 680 records for Technology Services to industry_data_from_db\technology_services_training.csv
2025-04-06 15:15:00,835 - __main__ - INFO - Training model for Technology Services with 680 records
2025-04-06 15:15:00,835 - __main__ - INFO - Training model for Technology Services with 680 records
2025-04-06 15:15:00,835 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:00,836 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:00,858 - __main__ - ERROR - Error training model for Technology Services: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\technology_services_checkpoint
2025-04-06 15:15:00,858 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\technology_services_checkpoint

2025-04-06 15:15:00,858 - __main__ - WARNING - Failed to train model for Technology Services
2025-04-06 15:15:00,858 - __main__ - INFO - Processing industry 17/34: Food & Beverage
2025-04-06 15:15:00,859 - __main__ - INFO - Found 42 stocks in Food & Beverage industry
2025-04-06 15:15:01,874 - __main__ - INFO - Saved 616 records for Food & Beverage to industry_data_from_db\food_&_beverage_training.csv
2025-04-06 15:15:03,253 - __main__ - INFO - Training model for Food & Beverage with 616 records
2025-04-06 15:15:03,253 - __main__ - INFO - Training model for Food & Beverage with 616 records
2025-04-06 15:15:03,253 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:03,254 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:03,256 - __main__ - ERROR - Error training model for Food & Beverage: Input X contains infinity or a value too large for dtype('float64').
2025-04-06 15:15:03,256 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 534, in train_industry_model
    X_train_scaled = scaler.fit_transform(X_train)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 918, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\preprocessing\_data.py", line 1624, in fit
    X = validate_data(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 1107, in check_array
    _assert_all_finite(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains infinity or a value too large for dtype('float64').

2025-04-06 15:15:03,257 - __main__ - WARNING - Failed to train model for Food & Beverage
2025-04-06 15:15:03,257 - __main__ - INFO - Processing industry 18/34: Automotive
2025-04-06 15:15:03,258 - __main__ - INFO - Found 39 stocks in Automotive industry
2025-04-06 15:15:04,483 - __main__ - INFO - Saved 641 records for Automotive to industry_data_from_db\automotive_training.csv
2025-04-06 15:15:05,002 - __main__ - INFO - Training model for Automotive with 641 records
2025-04-06 15:15:05,003 - __main__ - INFO - Training model for Automotive with 641 records
2025-04-06 15:15:05,003 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:05,004 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:05,025 - __main__ - ERROR - Error training model for Automotive: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\automotive_checkpoint
2025-04-06 15:15:05,025 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\automotive_checkpoint

2025-04-06 15:15:05,026 - __main__ - WARNING - Failed to train model for Automotive
2025-04-06 15:15:05,026 - __main__ - INFO - Processing industry 19/34: Retail
2025-04-06 15:15:05,027 - __main__ - INFO - Found 37 stocks in Retail industry
2025-04-06 15:15:06,109 - __main__ - INFO - Saved 652 records for Retail to industry_data_from_db\retail_training.csv
2025-04-06 15:15:06,870 - __main__ - INFO - Training model for Retail with 652 records
2025-04-06 15:15:06,870 - __main__ - INFO - Training model for Retail with 652 records
2025-04-06 15:15:06,871 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:06,871 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:06,893 - __main__ - ERROR - Error training model for Retail: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\retail_checkpoint
2025-04-06 15:15:06,894 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\retail_checkpoint

2025-04-06 15:15:06,894 - __main__ - WARNING - Failed to train model for Retail
2025-04-06 15:15:06,894 - __main__ - INFO - Processing industry 20/34: Media & Entertainment
2025-04-06 15:15:06,896 - __main__ - INFO - Found 37 stocks in Media & Entertainment industry
2025-04-06 15:15:08,019 - __main__ - INFO - Saved 582 records for Media & Entertainment to industry_data_from_db\media_&_entertainment_training.csv
2025-04-06 15:15:09,726 - __main__ - INFO - Training model for Media & Entertainment with 582 records
2025-04-06 15:15:09,726 - __main__ - INFO - Training model for Media & Entertainment with 582 records
2025-04-06 15:15:09,726 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:09,727 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:09,729 - __main__ - ERROR - Error training model for Media & Entertainment: Input X contains infinity or a value too large for dtype('float64').
2025-04-06 15:15:09,730 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 534, in train_industry_model
    X_train_scaled = scaler.fit_transform(X_train)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 918, in fit_transform
    return self.fit(X, **fit_params).transform(X)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\preprocessing\_data.py", line 1624, in fit
    X = validate_data(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 2944, in validate_data
    out = check_array(X, input_name="X", **check_params)
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 1107, in check_array
    _assert_all_finite(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 120, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\sklearn\utils\validation.py", line 169, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input X contains infinity or a value too large for dtype('float64').

2025-04-06 15:15:09,730 - __main__ - WARNING - Failed to train model for Media & Entertainment
2025-04-06 15:15:09,730 - __main__ - INFO - Processing industry 21/34: Shipping & Transportation
2025-04-06 15:15:09,732 - __main__ - INFO - Found 36 stocks in Shipping & Transportation industry
2025-04-06 15:15:10,744 - __main__ - INFO - Saved 614 records for Shipping & Transportation to industry_data_from_db\shipping_&_transportation_training.csv
2025-04-06 15:15:11,260 - __main__ - INFO - Training model for Shipping & Transportation with 614 records
2025-04-06 15:15:11,260 - __main__ - INFO - Training model for Shipping & Transportation with 614 records
2025-04-06 15:15:11,260 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:11,261 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:11,576 - __main__ - ERROR - Error training model for Shipping & Transportation: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\shipping_&_transportation_checkpoint
2025-04-06 15:15:11,576 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\shipping_&_transportation_checkpoint

2025-04-06 15:15:11,576 - __main__ - WARNING - Failed to train model for Shipping & Transportation
2025-04-06 15:15:11,576 - __main__ - INFO - Processing industry 22/34: Sports & Leisure
2025-04-06 15:15:11,577 - __main__ - INFO - Found 30 stocks in Sports & Leisure industry
2025-04-06 15:15:12,307 - __main__ - INFO - Saved 462 records for Sports & Leisure to industry_data_from_db\sports_&_leisure_training.csv
2025-04-06 15:15:12,769 - __main__ - INFO - Training model for Sports & Leisure with 462 records
2025-04-06 15:15:12,770 - __main__ - INFO - Training model for Sports & Leisure with 462 records
2025-04-06 15:15:12,770 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:12,771 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:12,790 - __main__ - ERROR - Error training model for Sports & Leisure: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\sports_&_leisure_checkpoint
2025-04-06 15:15:12,791 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\sports_&_leisure_checkpoint

2025-04-06 15:15:12,791 - __main__ - WARNING - Failed to train model for Sports & Leisure
2025-04-06 15:15:12,791 - __main__ - INFO - Processing industry 23/34: Materials
2025-04-06 15:15:12,792 - __main__ - INFO - Found 29 stocks in Materials industry
2025-04-06 15:15:13,557 - __main__ - INFO - Saved 494 records for Materials to industry_data_from_db\materials_training.csv
2025-04-06 15:15:14,319 - __main__ - INFO - Training model for Materials with 494 records
2025-04-06 15:15:14,319 - __main__ - INFO - Training model for Materials with 494 records
2025-04-06 15:15:14,319 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:14,320 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:14,340 - __main__ - ERROR - Error training model for Materials: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\materials_checkpoint
2025-04-06 15:15:14,341 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\materials_checkpoint

2025-04-06 15:15:14,341 - __main__ - WARNING - Failed to train model for Materials
2025-04-06 15:15:14,341 - __main__ - INFO - Processing industry 24/34: Cloud Computing
2025-04-06 15:15:14,342 - __main__ - INFO - Found 23 stocks in Cloud Computing industry
2025-04-06 15:15:14,619 - __main__ - INFO - Saved 166 records for Cloud Computing to industry_data_from_db\cloud_computing_training.csv
2025-04-06 15:15:15,052 - __main__ - INFO - Training model for Cloud Computing with 166 records
2025-04-06 15:15:15,052 - __main__ - INFO - Training model for Cloud Computing with 166 records
2025-04-06 15:15:15,052 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:15,053 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:15,076 - __main__ - ERROR - Error training model for Cloud Computing: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\cloud_computing_checkpoint
2025-04-06 15:15:15,076 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\cloud_computing_checkpoint

2025-04-06 15:15:15,076 - __main__ - WARNING - Failed to train model for Cloud Computing
2025-04-06 15:15:15,077 - __main__ - INFO - Processing industry 25/34: Chemicals
2025-04-06 15:15:15,078 - __main__ - INFO - Found 23 stocks in Chemicals industry
2025-04-06 15:15:15,556 - __main__ - INFO - Saved 305 records for Chemicals to industry_data_from_db\chemicals_training.csv
2025-04-06 15:15:16,260 - __main__ - INFO - Training model for Chemicals with 305 records
2025-04-06 15:15:16,260 - __main__ - INFO - Training model for Chemicals with 305 records
2025-04-06 15:15:16,260 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:16,261 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:16,279 - __main__ - ERROR - Error training model for Chemicals: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\chemicals_checkpoint
2025-04-06 15:15:16,280 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\chemicals_checkpoint

2025-04-06 15:15:16,280 - __main__ - WARNING - Failed to train model for Chemicals
2025-04-06 15:15:16,280 - __main__ - INFO - Processing industry 26/34: Electrical Equipment
2025-04-06 15:15:16,281 - __main__ - INFO - Found 22 stocks in Electrical Equipment industry
2025-04-06 15:15:16,788 - __main__ - INFO - Saved 336 records for Electrical Equipment to industry_data_from_db\electrical_equipment_training.csv
2025-04-06 15:15:17,226 - __main__ - INFO - Training model for Electrical Equipment with 336 records
2025-04-06 15:15:17,226 - __main__ - INFO - Training model for Electrical Equipment with 336 records
2025-04-06 15:15:17,227 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:17,227 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:17,247 - __main__ - ERROR - Error training model for Electrical Equipment: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\electrical_equipment_checkpoint
2025-04-06 15:15:17,247 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\electrical_equipment_checkpoint

2025-04-06 15:15:17,247 - __main__ - WARNING - Failed to train model for Electrical Equipment
2025-04-06 15:15:17,247 - __main__ - INFO - Processing industry 27/34: Home & Living
2025-04-06 15:15:17,249 - __main__ - INFO - Found 21 stocks in Home & Living industry
2025-04-06 15:15:17,932 - __main__ - INFO - Saved 318 records for Home & Living to industry_data_from_db\home_&_living_training.csv
2025-04-06 15:15:18,363 - __main__ - INFO - Training model for Home & Living with 318 records
2025-04-06 15:15:18,363 - __main__ - INFO - Training model for Home & Living with 318 records
2025-04-06 15:15:18,363 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:18,363 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:18,384 - __main__ - ERROR - Error training model for Home & Living: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\home_&_living_checkpoint
2025-04-06 15:15:18,385 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\home_&_living_checkpoint

2025-04-06 15:15:18,385 - __main__ - WARNING - Failed to train model for Home & Living
2025-04-06 15:15:18,385 - __main__ - INFO - Processing industry 28/34: Utilities
2025-04-06 15:15:18,386 - __main__ - INFO - Found 13 stocks in Utilities industry
2025-04-06 15:15:18,752 - __main__ - INFO - Saved 237 records for Utilities to industry_data_from_db\utilities_training.csv
2025-04-06 15:15:19,357 - __main__ - INFO - Training model for Utilities with 237 records
2025-04-06 15:15:19,357 - __main__ - INFO - Training model for Utilities with 237 records
2025-04-06 15:15:19,358 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:19,358 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:19,377 - __main__ - ERROR - Error training model for Utilities: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\utilities_checkpoint
2025-04-06 15:15:19,377 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\utilities_checkpoint

2025-04-06 15:15:19,377 - __main__ - WARNING - Failed to train model for Utilities
2025-04-06 15:15:19,377 - __main__ - INFO - Processing industry 29/34: Rubber & Plastics
2025-04-06 15:15:19,378 - __main__ - INFO - Found 12 stocks in Rubber & Plastics industry
2025-04-06 15:15:19,720 - __main__ - INFO - Saved 217 records for Rubber & Plastics to industry_data_from_db\rubber_&_plastics_training.csv
2025-04-06 15:15:20,167 - __main__ - INFO - Training model for Rubber & Plastics with 217 records
2025-04-06 15:15:20,167 - __main__ - INFO - Training model for Rubber & Plastics with 217 records
2025-04-06 15:15:20,167 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:20,168 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:20,187 - __main__ - ERROR - Error training model for Rubber & Plastics: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\rubber_&_plastics_checkpoint
2025-04-06 15:15:20,188 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\rubber_&_plastics_checkpoint

2025-04-06 15:15:20,188 - __main__ - WARNING - Failed to train model for Rubber & Plastics
2025-04-06 15:15:20,188 - __main__ - INFO - Processing industry 30/34: E-Commerce
2025-04-06 15:15:20,189 - __main__ - INFO - Found 9 stocks in E-Commerce industry
2025-04-06 15:15:20,450 - __main__ - INFO - Saved 168 records for E-Commerce to industry_data_from_db\e-commerce_training.csv
2025-04-06 15:15:21,098 - __main__ - INFO - Training model for E-Commerce with 168 records
2025-04-06 15:15:21,099 - __main__ - INFO - Training model for E-Commerce with 168 records
2025-04-06 15:15:21,099 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:21,099 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:21,121 - __main__ - ERROR - Error training model for E-Commerce: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\e-commerce_checkpoint
2025-04-06 15:15:21,121 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\e-commerce_checkpoint

2025-04-06 15:15:21,121 - __main__ - WARNING - Failed to train model for E-Commerce
2025-04-06 15:15:21,121 - __main__ - INFO - Processing industry 31/34: Paper & Packaging
2025-04-06 15:15:21,123 - __main__ - INFO - Found 8 stocks in Paper & Packaging industry
2025-04-06 15:15:21,324 - __main__ - INFO - Saved 132 records for Paper & Packaging to industry_data_from_db\paper_&_packaging_training.csv
2025-04-06 15:15:21,749 - __main__ - INFO - Training model for Paper & Packaging with 132 records
2025-04-06 15:15:21,750 - __main__ - INFO - Training model for Paper & Packaging with 132 records
2025-04-06 15:15:21,750 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:21,751 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:21,770 - __main__ - ERROR - Error training model for Paper & Packaging: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\paper_&_packaging_checkpoint
2025-04-06 15:15:21,770 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\paper_&_packaging_checkpoint

2025-04-06 15:15:21,771 - __main__ - WARNING - Failed to train model for Paper & Packaging
2025-04-06 15:15:21,771 - __main__ - INFO - Processing industry 32/34: Cement & Construction Materials
2025-04-06 15:15:21,772 - __main__ - INFO - Found 8 stocks in Cement & Construction Materials industry
2025-04-06 15:15:21,979 - __main__ - INFO - Saved 133 records for Cement & Construction Materials to industry_data_from_db\cement_&_construction_materials_training.csv
2025-04-06 15:15:22,375 - __main__ - INFO - Training model for Cement & Construction Materials with 133 records
2025-04-06 15:15:22,376 - __main__ - INFO - Training model for Cement & Construction Materials with 133 records
2025-04-06 15:15:22,376 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:22,376 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:22,395 - __main__ - ERROR - Error training model for Cement & Construction Materials: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\cement_&_construction_materials_checkpoint
2025-04-06 15:15:22,396 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\cement_&_construction_materials_checkpoint

2025-04-06 15:15:22,396 - __main__ - WARNING - Failed to train model for Cement & Construction Materials
2025-04-06 15:15:22,396 - __main__ - INFO - Processing industry 33/34: Agricultural Technology
2025-04-06 15:15:22,397 - __main__ - INFO - Found 6 stocks in Agricultural Technology industry
2025-04-06 15:15:22,748 - __main__ - INFO - Saved 92 records for Agricultural Technology to industry_data_from_db\agricultural_technology_training.csv
2025-04-06 15:15:23,199 - __main__ - INFO - Training model for Agricultural Technology with 92 records
2025-04-06 15:15:23,199 - __main__ - INFO - Training model for Agricultural Technology with 92 records
2025-04-06 15:15:23,199 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:23,200 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:23,220 - __main__ - ERROR - Error training model for Agricultural Technology: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\agricultural_technology_checkpoint
2025-04-06 15:15:23,220 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\agricultural_technology_checkpoint

2025-04-06 15:15:23,220 - __main__ - WARNING - Failed to train model for Agricultural Technology
2025-04-06 15:15:23,220 - __main__ - INFO - Processing industry 34/34: Glass & Ceramics
2025-04-06 15:15:23,222 - __main__ - INFO - Found 5 stocks in Glass & Ceramics industry
2025-04-06 15:15:23,401 - __main__ - INFO - Saved 95 records for Glass & Ceramics to industry_data_from_db\glass_&_ceramics_training.csv
2025-04-06 15:15:23,840 - __main__ - INFO - Training model for Glass & Ceramics with 95 records
2025-04-06 15:15:23,840 - __main__ - INFO - Training model for Glass & Ceramics with 95 records
2025-04-06 15:15:23,841 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:15:23,841 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:15:23,861 - __main__ - ERROR - Error training model for Glass & Ceramics: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\glass_&_ceramics_checkpoint
2025-04-06 15:15:23,861 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 560, in train_industry_model
    model_checkpoint = tf.keras.callbacks.ModelCheckpoint(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\callbacks\model_checkpoint.py", line 184, in __init__
    raise ValueError(
ValueError: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=industry_data_from_db\models\glass_&_ceramics_checkpoint

2025-04-06 15:15:23,861 - __main__ - WARNING - Failed to train model for Glass & Ceramics
2025-04-06 15:15:23,861 - __main__ - INFO - Creating benchmarks from 34 industry datasets
2025-04-06 15:15:23,867 - __main__ - INFO - Processed benchmarks for agricultural technology: 92 records
2025-04-06 15:15:23,873 - __main__ - INFO - Processed benchmarks for automotive: 641 records
2025-04-06 15:15:23,878 - __main__ - INFO - Processed benchmarks for cement & construction materials: 133 records
2025-04-06 15:15:23,884 - __main__ - INFO - Processed benchmarks for chemicals: 305 records
2025-04-06 15:15:23,889 - __main__ - INFO - Processed benchmarks for cloud computing: 166 records
2025-04-06 15:15:23,898 - __main__ - INFO - Processed benchmarks for computer hardware: 2213 records
2025-04-06 15:15:23,906 - __main__ - INFO - Processed benchmarks for construction: 1462 records
2025-04-06 15:15:23,911 - __main__ - INFO - Processed benchmarks for e-commerce: 168 records
2025-04-06 15:15:23,916 - __main__ - INFO - Processed benchmarks for electrical equipment: 336 records
2025-04-06 15:15:23,923 - __main__ - INFO - Processed benchmarks for electronics distribution: 719 records
2025-04-06 15:15:23,937 - __main__ - INFO - Processed benchmarks for electronics manufacturing: 4215 records
2025-04-06 15:15:23,960 - __main__ - INFO - Processed benchmarks for electronics: 6885 records
2025-04-06 15:15:23,966 - __main__ - INFO - Processed benchmarks for financial services: 204 records
2025-04-06 15:15:23,973 - __main__ - INFO - Processed benchmarks for food & beverage: 616 records
2025-04-06 15:15:23,978 - __main__ - INFO - Processed benchmarks for glass & ceramics: 95 records
2025-04-06 15:15:23,986 - __main__ - INFO - Processed benchmarks for green energy: 626 records
2025-04-06 15:15:23,998 - __main__ - INFO - Processed benchmarks for healthcare: 3663 records
2025-04-06 15:15:24,003 - __main__ - INFO - Processed benchmarks for home & living: 318 records
2025-04-06 15:15:24,016 - __main__ - INFO - Processed benchmarks for industrial equipment: 2032 records
2025-04-06 15:15:24,023 - __main__ - INFO - Processed benchmarks for materials: 494 records
2025-04-06 15:15:24,030 - __main__ - INFO - Processed benchmarks for media & entertainment: 582 records
2025-04-06 15:15:24,038 - __main__ - INFO - Processed benchmarks for other: 1637 records
2025-04-06 15:15:24,043 - __main__ - INFO - Processed benchmarks for paper & packaging: 132 records
2025-04-06 15:15:24,050 - __main__ - INFO - Processed benchmarks for retail: 652 records
2025-04-06 15:15:24,055 - __main__ - INFO - Processed benchmarks for rubber & plastics: 217 records
2025-04-06 15:15:24,064 - __main__ - INFO - Processed benchmarks for semiconductors: 1905 records
2025-04-06 15:15:24,071 - __main__ - INFO - Processed benchmarks for shipping & transportation: 614 records
2025-04-06 15:15:24,077 - __main__ - INFO - Processed benchmarks for sports & leisure: 462 records
2025-04-06 15:15:24,085 - __main__ - INFO - Processed benchmarks for steel & metals: 930 records
2025-04-06 15:15:24,092 - __main__ - INFO - Processed benchmarks for technology services: 680 records
2025-04-06 15:15:24,100 - __main__ - INFO - Processed benchmarks for telecommunications: 970 records
2025-04-06 15:15:24,109 - __main__ - INFO - Processed benchmarks for textiles: 1049 records
2025-04-06 15:15:24,118 - __main__ - INFO - Processed benchmarks for tourism & hospitality: 954 records
2025-04-06 15:15:24,124 - __main__ - INFO - Processed benchmarks for utilities: 237 records
2025-04-06 15:15:24,212 - __main__ - INFO - Saved industry benchmarks for 34 industries
2025-04-06 15:15:24,213 - __main__ - INFO - Training completed in 0:01:56.607840. Successful: 0/34
2025-04-06 15:15:24,213 - __main__ - INFO - Successful industries: []
2025-04-06 15:15:24,213 - __main__ - INFO - Training process completed
2025-04-06 15:19:22,533 - __main__ - INFO - Starting comprehensive model training
2025-04-06 15:19:22,535 - __main__ - WARNING - No GPU found, using CPU instead
2025-04-06 15:19:22,535 - __main__ - INFO - Using default configuration
2025-04-06 15:19:22,535 - __main__ - INFO - Starting comprehensive model training at 2025-04-06 15:19:22.535054
2025-04-06 15:19:22,537 - __main__ - INFO - Found 34 industries in database
2025-04-06 15:19:22,538 - __main__ - INFO - Found 34 industries with at least 5 stocks
2025-04-06 15:19:22,538 - __main__ - INFO - Processing industry 1/34: Electronics
2025-04-06 15:19:22,539 - __main__ - INFO - Found 452 stocks in Electronics industry
2025-04-06 15:19:33,297 - __main__ - INFO - Saved 6885 records for Electronics to industry_data_from_db\electronics_training.csv
2025-04-06 15:19:33,980 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:19:33,981 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:19:33,981 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:19:33,982 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:19:34,049 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:19:34,050 - __main__ - INFO - Training fold 1/5
2025-04-06 15:19:47,334 - __main__ - INFO - Training fold 2/5
2025-04-06 15:19:47,444 - __main__ - ERROR - Error training model for Electronics: numpy() is only available when eager execution is enabled.
2025-04-06 15:19:47,463 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 620, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend\tensorflow\core.py", line 158, in convert_to_numpy
    return np.array(x)
NotImplementedError: numpy() is only available when eager execution is enabled.

2025-04-06 15:19:47,463 - __main__ - WARNING - Failed to train model for Electronics
2025-04-06 15:19:47,464 - __main__ - INFO - Processing industry 2/34: Healthcare
2025-04-06 15:19:47,465 - __main__ - INFO - Found 280 stocks in Healthcare industry
2025-04-06 15:19:53,829 - __main__ - INFO - Saved 3663 records for Healthcare to industry_data_from_db\healthcare_training.csv
2025-04-06 15:19:59,798 - __main__ - INFO - Training model for Healthcare with 3663 records
2025-04-06 15:19:59,798 - __main__ - INFO - Training model for Healthcare with 3663 records
2025-04-06 15:19:59,799 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:19:59,799 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:19:59,831 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:19:59,832 - __main__ - INFO - Training fold 1/5
2025-04-06 15:20:09,337 - __main__ - INFO - Training fold 2/5
2025-04-06 15:20:09,418 - __main__ - ERROR - Error training model for Healthcare: numpy() is only available when eager execution is enabled.
2025-04-06 15:20:09,419 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 620, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend\tensorflow\core.py", line 158, in convert_to_numpy
    return np.array(x)
NotImplementedError: numpy() is only available when eager execution is enabled.

2025-04-06 15:20:09,419 - __main__ - WARNING - Failed to train model for Healthcare
2025-04-06 15:20:09,419 - __main__ - INFO - Processing industry 3/34: Electronics Manufacturing
2025-04-06 15:20:09,420 - __main__ - INFO - Found 246 stocks in Electronics Manufacturing industry
2025-04-06 15:20:16,452 - __main__ - INFO - Saved 4215 records for Electronics Manufacturing to industry_data_from_db\electronics_manufacturing_training.csv
2025-04-06 15:20:21,730 - __main__ - INFO - Training model for Electronics Manufacturing with 4215 records
2025-04-06 15:20:21,730 - __main__ - INFO - Training model for Electronics Manufacturing with 4215 records
2025-04-06 15:20:21,730 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:20:21,731 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:20:21,759 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:20:21,759 - __main__ - INFO - Training fold 1/5
2025-04-06 15:20:24,382 - __main__ - INFO - Training fold 2/5
2025-04-06 15:20:24,478 - __main__ - ERROR - Error training model for Electronics Manufacturing: numpy() is only available when eager execution is enabled.
2025-04-06 15:20:24,478 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 620, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend\tensorflow\core.py", line 158, in convert_to_numpy
    return np.array(x)
NotImplementedError: numpy() is only available when eager execution is enabled.

2025-04-06 15:20:24,479 - __main__ - WARNING - Failed to train model for Electronics Manufacturing
2025-04-06 15:20:24,479 - __main__ - INFO - Processing industry 4/34: Other
2025-04-06 15:20:24,480 - __main__ - INFO - Found 222 stocks in Other industry
2025-04-06 15:20:27,071 - __main__ - INFO - Saved 1637 records for Other to industry_data_from_db\other_training.csv
2025-04-06 15:20:29,129 - __main__ - INFO - Training model for Other with 1637 records
2025-04-06 15:20:29,129 - __main__ - INFO - Training model for Other with 1637 records
2025-04-06 15:20:29,130 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:20:29,130 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:20:29,157 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:20:29,157 - __main__ - INFO - Training fold 1/5
2025-04-06 15:20:32,488 - __main__ - INFO - Training fold 2/5
2025-04-06 15:20:32,595 - __main__ - ERROR - Error training model for Other: numpy() is only available when eager execution is enabled.
2025-04-06 15:20:32,595 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 620, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\backend\tensorflow\core.py", line 158, in convert_to_numpy
    return np.array(x)
NotImplementedError: numpy() is only available when eager execution is enabled.

2025-04-06 15:20:32,596 - __main__ - WARNING - Failed to train model for Other
2025-04-06 15:20:32,596 - __main__ - INFO - Processing industry 5/34: Computer Hardware
2025-04-06 15:20:32,598 - __main__ - INFO - Found 137 stocks in Computer Hardware industry
2025-04-06 15:20:36,391 - __main__ - INFO - Saved 2213 records for Computer Hardware to industry_data_from_db\computer_hardware_training.csv
2025-04-06 15:20:36,954 - __main__ - INFO - Training model for Computer Hardware with 2213 records
2025-04-06 15:20:36,954 - __main__ - INFO - Training model for Computer Hardware with 2213 records
2025-04-06 15:20:36,954 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:20:36,955 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:20:36,982 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:20:36,983 - __main__ - INFO - Training fold 1/5
2025-04-06 15:25:32,295 - __main__ - INFO - Starting comprehensive model training
2025-04-06 15:25:32,296 - __main__ - WARNING - No GPU found, using CPU instead
2025-04-06 15:25:32,296 - __main__ - INFO - Using default configuration
2025-04-06 15:25:32,296 - __main__ - INFO - Starting comprehensive model training at 2025-04-06 15:25:32.296585
2025-04-06 15:25:32,300 - __main__ - INFO - Found 34 industries in database
2025-04-06 15:25:32,300 - __main__ - INFO - Found 34 industries with at least 5 stocks
2025-04-06 15:25:32,300 - __main__ - INFO - Processing industry 1/34: Electronics
2025-04-06 15:25:32,301 - __main__ - INFO - Found 452 stocks in Electronics industry
2025-04-06 15:25:46,233 - __main__ - INFO - Saved 6885 records for Electronics to industry_data_from_db\electronics_training.csv
2025-04-06 15:25:46,965 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:25:46,966 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:25:46,966 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:25:46,967 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:25:47,034 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:25:47,035 - __main__ - INFO - Training fold 1/5
2025-04-06 15:31:24,806 - __main__ - INFO - Starting comprehensive model training
2025-04-06 15:31:24,807 - __main__ - WARNING - No GPU found, using CPU instead
2025-04-06 15:31:24,807 - __main__ - INFO - Using default configuration
2025-04-06 15:31:24,807 - __main__ - INFO - Starting comprehensive model training at 2025-04-06 15:31:24.807538
2025-04-06 15:31:24,810 - __main__ - INFO - Found 34 industries in database
2025-04-06 15:31:24,810 - __main__ - INFO - Found 34 industries with at least 5 stocks
2025-04-06 15:31:24,810 - __main__ - INFO - Processing industry 1/34: Electronics
2025-04-06 15:31:24,811 - __main__ - INFO - Found 452 stocks in Electronics industry
2025-04-06 15:31:35,464 - __main__ - INFO - Saved 6885 records for Electronics to industry_data_from_db\electronics_training.csv
2025-04-06 15:31:36,150 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:31:36,150 - __main__ - INFO - Training model for Electronics with 6885 records
2025-04-06 15:31:36,151 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:31:36,151 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:31:36,217 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:31:36,217 - __main__ - INFO - Training fold 1/5
2025-04-06 15:35:16,896 - __main__ - INFO - Training fold 2/5
2025-04-06 15:35:17,094 - __main__ - ERROR - Error training model for Electronics: Unknown variable: <Variable path=sequential_2/dense_6/kernel, shape=(8, 16), dtype=float32, value=[[-0.453223    0.09929287  0.2701701  -0.3822987   0.03595769 -0.46006262
   0.1812247  -0.44017935  0.42980206 -0.22802651  0.48393834 -0.19840908
   0.36424136 -0.3319502  -0.17445028 -0.10887909]
 [-0.2774489  -0.01949608 -0.05875933  0.21129775 -0.252571   -0.29176736
  -0.4994638  -0.35787725  0.3000281   0.34719503  0.27793622  0.07383239
  -0.49790514 -0.05114996 -0.28306293 -0.4790932 ]
 [-0.243433    0.01491177 -0.27439356 -0.24172747  0.42913222  0.01230013
   0.3457309  -0.15685534 -0.3155942  -0.24089861  0.29817796 -0.16081345
   0.43331325 -0.20095825 -0.36349738  0.06187224]
 [ 0.35827017  0.27844238 -0.4752084   0.07662284 -0.25641358 -0.18679798
   0.34471166  0.324167    0.10857892 -0.43198156 -0.16955197  0.10966825
   0.46218288 -0.41132104  0.08268356  0.2125988 ]
 [-0.23351264 -0.3987285   0.30179584  0.41438043 -0.20981681 -0.19447899
   0.44349062 -0.3838756  -0.2515179   0.17115712 -0.15597904  0.06588161
  -0.00458598  0.25959563  0.15983117 -0.3182168 ]
 [ 0.13631845  0.15901077 -0.10385132  0.46564686 -0.266873    0.18137848
  -0.00147521 -0.09399676  0.18778205 -0.17273927 -0.4779725   0.15572608
  -0.4151138  -0.15059257 -0.3781705  -0.24814916]
 [ 0.21362376 -0.3128239  -0.09274852 -0.34947252  0.4997152   0.3418957
   0.01281154  0.36565244  0.39270782  0.15716326 -0.20107675  0.1360414
  -0.1554141  -0.400959    0.03986061 -0.01564348]
 [ 0.43112314 -0.0857836   0.10924006  0.3879094   0.11476195 -0.3150674
   0.27572083  0.40069568 -0.04172349  0.10830808 -0.28248382 -0.16209126
   0.24194753 -0.1458726  -0.08847153 -0.3772968 ]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:35:17,105 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_2/dense_6/kernel, shape=(8, 16), dtype=float32, value=[[-0.453223    0.09929287  0.2701701  -0.3822987   0.03595769 -0.46006262
   0.1812247  -0.44017935  0.42980206 -0.22802651  0.48393834 -0.19840908
   0.36424136 -0.3319502  -0.17445028 -0.10887909]
 [-0.2774489  -0.01949608 -0.05875933  0.21129775 -0.252571   -0.29176736
  -0.4994638  -0.35787725  0.3000281   0.34719503  0.27793622  0.07383239
  -0.49790514 -0.05114996 -0.28306293 -0.4790932 ]
 [-0.243433    0.01491177 -0.27439356 -0.24172747  0.42913222  0.01230013
   0.3457309  -0.15685534 -0.3155942  -0.24089861  0.29817796 -0.16081345
   0.43331325 -0.20095825 -0.36349738  0.06187224]
 [ 0.35827017  0.27844238 -0.4752084   0.07662284 -0.25641358 -0.18679798
   0.34471166  0.324167    0.10857892 -0.43198156 -0.16955197  0.10966825
   0.46218288 -0.41132104  0.08268356  0.2125988 ]
 [-0.23351264 -0.3987285   0.30179584  0.41438043 -0.20981681 -0.19447899
   0.44349062 -0.3838756  -0.2515179   0.17115712 -0.15597904  0.06588161
  -0.00458598  0.25959563  0.15983117 -0.3182168 ]
 [ 0.13631845  0.15901077 -0.10385132  0.46564686 -0.266873    0.18137848
  -0.00147521 -0.09399676  0.18778205 -0.17273927 -0.4779725   0.15572608
  -0.4151138  -0.15059257 -0.3781705  -0.24814916]
 [ 0.21362376 -0.3128239  -0.09274852 -0.34947252  0.4997152   0.3418957
   0.01281154  0.36565244  0.39270782  0.15716326 -0.20107675  0.1360414
  -0.1554141  -0.400959    0.03986061 -0.01564348]
 [ 0.43112314 -0.0857836   0.10924006  0.3879094   0.11476195 -0.3150674
   0.27572083  0.40069568 -0.04172349  0.10830808 -0.28248382 -0.16209126
   0.24194753 -0.1458726  -0.08847153 -0.3772968 ]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:35:17,106 - __main__ - WARNING - Failed to train model for Electronics
2025-04-06 15:35:17,106 - __main__ - INFO - Processing industry 2/34: Healthcare
2025-04-06 15:35:17,107 - __main__ - INFO - Found 280 stocks in Healthcare industry
2025-04-06 15:35:23,182 - __main__ - INFO - Saved 3663 records for Healthcare to industry_data_from_db\healthcare_training.csv
2025-04-06 15:35:29,429 - __main__ - INFO - Training model for Healthcare with 3663 records
2025-04-06 15:35:29,429 - __main__ - INFO - Training model for Healthcare with 3663 records
2025-04-06 15:35:29,429 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:35:29,430 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:35:29,463 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:35:29,464 - __main__ - INFO - Training fold 1/5
2025-04-06 15:37:20,355 - __main__ - INFO - Training fold 2/5
2025-04-06 15:37:20,411 - __main__ - ERROR - Error training model for Healthcare: Unknown variable: <Variable path=sequential_5/dense_15/kernel, shape=(8, 16), dtype=float32, value=[[-0.1723659  -0.20920551  0.34977043  0.17000091  0.4354936  -0.14072466
  -0.1558485   0.46645963  0.28068888  0.3439213   0.33027148 -0.45333982
   0.11015177 -0.06589031 -0.2807722   0.23807168]
 [-0.38266218 -0.17371798  0.0437361  -0.494892    0.16861463 -0.08461797
  -0.3212675   0.47005606 -0.09481192 -0.13449097 -0.4547752   0.06619608
   0.16434097  0.13743746 -0.16256595  0.4224273 ]
 [-0.2019918  -0.1548742   0.3905716  -0.34916687 -0.47764575 -0.4392767
  -0.32911134 -0.26551545  0.34693623 -0.04739261  0.28532636 -0.40313447
  -0.32942498 -0.37403238  0.01673019 -0.2085917 ]
 [ 0.05888379 -0.036497   -0.1544311  -0.47876728  0.46500146  0.1721704
  -0.1640284  -0.45819485  0.2236247   0.13664937 -0.23012853  0.47683167
  -0.47723663 -0.45957577 -0.36004162 -0.37645173]
 [ 0.47229958  0.25308967  0.2760918  -0.10478127 -0.3458141  -0.35313523
   0.42187798 -0.2216593  -0.24890137 -0.12134397 -0.29472864 -0.4444486
   0.18006265 -0.23002398 -0.43244517 -0.17754889]
 [-0.07864833 -0.37118065  0.29165947 -0.38339043 -0.20476305 -0.01738024
   0.29238582 -0.32592535 -0.23933244  0.4645276  -0.47397196  0.09771514
   0.2614982  -0.15117157  0.22037649  0.37969375]
 [-0.15001631  0.23711312 -0.45612454  0.17275572  0.4498533   0.34672725
  -0.23620534  0.24739122  0.3676362   0.43336606  0.09390247  0.21072364
   0.4153148  -0.4385277  -0.17704487 -0.31076074]
 [-0.22541225  0.4355291   0.44629633  0.25597298 -0.10094786  0.13454974
  -0.05992639  0.11785519 -0.4271145   0.17700994  0.00464201 -0.07615888
  -0.15796745  0.38245475  0.22151184  0.02430511]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:37:20,412 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_5/dense_15/kernel, shape=(8, 16), dtype=float32, value=[[-0.1723659  -0.20920551  0.34977043  0.17000091  0.4354936  -0.14072466
  -0.1558485   0.46645963  0.28068888  0.3439213   0.33027148 -0.45333982
   0.11015177 -0.06589031 -0.2807722   0.23807168]
 [-0.38266218 -0.17371798  0.0437361  -0.494892    0.16861463 -0.08461797
  -0.3212675   0.47005606 -0.09481192 -0.13449097 -0.4547752   0.06619608
   0.16434097  0.13743746 -0.16256595  0.4224273 ]
 [-0.2019918  -0.1548742   0.3905716  -0.34916687 -0.47764575 -0.4392767
  -0.32911134 -0.26551545  0.34693623 -0.04739261  0.28532636 -0.40313447
  -0.32942498 -0.37403238  0.01673019 -0.2085917 ]
 [ 0.05888379 -0.036497   -0.1544311  -0.47876728  0.46500146  0.1721704
  -0.1640284  -0.45819485  0.2236247   0.13664937 -0.23012853  0.47683167
  -0.47723663 -0.45957577 -0.36004162 -0.37645173]
 [ 0.47229958  0.25308967  0.2760918  -0.10478127 -0.3458141  -0.35313523
   0.42187798 -0.2216593  -0.24890137 -0.12134397 -0.29472864 -0.4444486
   0.18006265 -0.23002398 -0.43244517 -0.17754889]
 [-0.07864833 -0.37118065  0.29165947 -0.38339043 -0.20476305 -0.01738024
   0.29238582 -0.32592535 -0.23933244  0.4645276  -0.47397196  0.09771514
   0.2614982  -0.15117157  0.22037649  0.37969375]
 [-0.15001631  0.23711312 -0.45612454  0.17275572  0.4498533   0.34672725
  -0.23620534  0.24739122  0.3676362   0.43336606  0.09390247  0.21072364
   0.4153148  -0.4385277  -0.17704487 -0.31076074]
 [-0.22541225  0.4355291   0.44629633  0.25597298 -0.10094786  0.13454974
  -0.05992639  0.11785519 -0.4271145   0.17700994  0.00464201 -0.07615888
  -0.15796745  0.38245475  0.22151184  0.02430511]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:37:20,412 - __main__ - WARNING - Failed to train model for Healthcare
2025-04-06 15:37:20,412 - __main__ - INFO - Processing industry 3/34: Electronics Manufacturing
2025-04-06 15:37:20,414 - __main__ - INFO - Found 246 stocks in Electronics Manufacturing industry
2025-04-06 15:37:28,563 - __main__ - INFO - Saved 4215 records for Electronics Manufacturing to industry_data_from_db\electronics_manufacturing_training.csv
2025-04-06 15:37:34,419 - __main__ - INFO - Training model for Electronics Manufacturing with 4215 records
2025-04-06 15:37:34,419 - __main__ - INFO - Training model for Electronics Manufacturing with 4215 records
2025-04-06 15:37:34,420 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:37:34,420 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:37:34,451 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:37:34,452 - __main__ - INFO - Training fold 1/5
2025-04-06 15:38:57,026 - __main__ - INFO - Training fold 2/5
2025-04-06 15:38:57,077 - __main__ - ERROR - Error training model for Electronics Manufacturing: Unknown variable: <Variable path=sequential_8/dense_24/kernel, shape=(8, 16), dtype=float32, value=[[ 4.05069828e-01  4.86253858e-01  3.36524248e-02 -5.81032038e-02
  -4.44726825e-01 -2.04806924e-01 -1.75976753e-01 -2.28659868e-01
   2.41052747e-01  3.94716024e-01 -3.04194450e-01  3.90339971e-01
   4.77101803e-02  4.72838640e-01 -2.51923203e-01 -3.04795980e-01]
 [ 2.35338211e-02 -3.28675508e-02 -3.85008097e-01  1.94654822e-01
   3.68417144e-01  1.57854438e-01 -3.36562514e-01  1.61280155e-01
  -3.36106539e-01 -1.44577503e-01  9.51220989e-02 -1.75416946e-01
  -2.22461224e-02  3.60673189e-01  3.57627869e-04 -1.49792194e-01]
 [-4.32614088e-01  3.73456597e-01  1.81635022e-01  4.03710604e-01
  -8.70721340e-02  3.81295085e-01  2.37537026e-01  2.10272193e-01
   4.20104742e-01 -3.55022669e-01  3.88952494e-01 -3.49172711e-01
  -1.68830395e-01  2.66862869e-01 -1.74509287e-01  2.87693977e-01]
 [-4.20733571e-01 -4.15817380e-01 -2.12943196e-01  3.93390656e-05
  -6.90805912e-03  3.09879899e-01  4.68020558e-01  1.34154916e-01
  -1.20751619e-01 -9.68024731e-02 -3.54499817e-02 -2.68123984e-01
   3.39296937e-01  2.25578547e-02 -2.60717869e-01  9.39024687e-02]
 [ 1.06538415e-01  4.99177337e-01  1.02976680e-01 -2.11523414e-01
  -2.19129324e-01  1.77164197e-01 -2.21406579e-01  1.39822841e-01
  -4.76143718e-01  1.78177595e-01  1.88429356e-01  3.39638233e-01
   4.51503158e-01 -1.91595674e-01  1.33787394e-02  1.58235312e-01]
 [ 4.78305817e-01 -2.14462399e-01 -1.31841183e-01 -4.77311969e-01
   3.68049026e-01 -2.56302357e-02  4.30796266e-01 -3.02259564e-01
  -3.39376926e-02 -2.07942724e-01 -2.59627819e-01  4.15415287e-01
   4.02092338e-01  2.33070731e-01  2.72967219e-01  7.96604156e-03]
 [ 9.08310413e-02  3.01940084e-01  2.33380198e-01 -6.44372702e-02
   4.98655677e-01 -2.71879196e-01 -1.00609541e-01  4.37618494e-01
  -4.87777829e-01 -4.33559179e-01  2.52736568e-01  4.26106334e-01
   3.37401986e-01 -1.36983991e-01  4.19616222e-01 -3.90191078e-02]
 [-2.04016805e-01  1.38999581e-01 -8.23508501e-02 -2.09041595e-01
  -1.31875157e-01  6.07374907e-02  4.01958585e-01 -5.10009527e-02
   2.00999260e-01  3.67105246e-01  3.35398555e-01 -7.61246681e-03
   4.59168077e-01  1.70501709e-01 -1.60562873e-01  3.08140635e-01]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:38:57,078 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_8/dense_24/kernel, shape=(8, 16), dtype=float32, value=[[ 4.05069828e-01  4.86253858e-01  3.36524248e-02 -5.81032038e-02
  -4.44726825e-01 -2.04806924e-01 -1.75976753e-01 -2.28659868e-01
   2.41052747e-01  3.94716024e-01 -3.04194450e-01  3.90339971e-01
   4.77101803e-02  4.72838640e-01 -2.51923203e-01 -3.04795980e-01]
 [ 2.35338211e-02 -3.28675508e-02 -3.85008097e-01  1.94654822e-01
   3.68417144e-01  1.57854438e-01 -3.36562514e-01  1.61280155e-01
  -3.36106539e-01 -1.44577503e-01  9.51220989e-02 -1.75416946e-01
  -2.22461224e-02  3.60673189e-01  3.57627869e-04 -1.49792194e-01]
 [-4.32614088e-01  3.73456597e-01  1.81635022e-01  4.03710604e-01
  -8.70721340e-02  3.81295085e-01  2.37537026e-01  2.10272193e-01
   4.20104742e-01 -3.55022669e-01  3.88952494e-01 -3.49172711e-01
  -1.68830395e-01  2.66862869e-01 -1.74509287e-01  2.87693977e-01]
 [-4.20733571e-01 -4.15817380e-01 -2.12943196e-01  3.93390656e-05
  -6.90805912e-03  3.09879899e-01  4.68020558e-01  1.34154916e-01
  -1.20751619e-01 -9.68024731e-02 -3.54499817e-02 -2.68123984e-01
   3.39296937e-01  2.25578547e-02 -2.60717869e-01  9.39024687e-02]
 [ 1.06538415e-01  4.99177337e-01  1.02976680e-01 -2.11523414e-01
  -2.19129324e-01  1.77164197e-01 -2.21406579e-01  1.39822841e-01
  -4.76143718e-01  1.78177595e-01  1.88429356e-01  3.39638233e-01
   4.51503158e-01 -1.91595674e-01  1.33787394e-02  1.58235312e-01]
 [ 4.78305817e-01 -2.14462399e-01 -1.31841183e-01 -4.77311969e-01
   3.68049026e-01 -2.56302357e-02  4.30796266e-01 -3.02259564e-01
  -3.39376926e-02 -2.07942724e-01 -2.59627819e-01  4.15415287e-01
   4.02092338e-01  2.33070731e-01  2.72967219e-01  7.96604156e-03]
 [ 9.08310413e-02  3.01940084e-01  2.33380198e-01 -6.44372702e-02
   4.98655677e-01 -2.71879196e-01 -1.00609541e-01  4.37618494e-01
  -4.87777829e-01 -4.33559179e-01  2.52736568e-01  4.26106334e-01
   3.37401986e-01 -1.36983991e-01  4.19616222e-01 -3.90191078e-02]
 [-2.04016805e-01  1.38999581e-01 -8.23508501e-02 -2.09041595e-01
  -1.31875157e-01  6.07374907e-02  4.01958585e-01 -5.10009527e-02
   2.00999260e-01  3.67105246e-01  3.35398555e-01 -7.61246681e-03
   4.59168077e-01  1.70501709e-01 -1.60562873e-01  3.08140635e-01]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:38:57,078 - __main__ - WARNING - Failed to train model for Electronics Manufacturing
2025-04-06 15:38:57,078 - __main__ - INFO - Processing industry 4/34: Other
2025-04-06 15:38:57,080 - __main__ - INFO - Found 222 stocks in Other industry
2025-04-06 15:39:00,135 - __main__ - INFO - Saved 1637 records for Other to industry_data_from_db\other_training.csv
2025-04-06 15:39:02,041 - __main__ - INFO - Training model for Other with 1637 records
2025-04-06 15:39:02,042 - __main__ - INFO - Training model for Other with 1637 records
2025-04-06 15:39:02,042 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:39:02,043 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:39:02,072 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:39:02,072 - __main__ - INFO - Training fold 1/5
2025-04-06 15:39:16,688 - __main__ - INFO - Training fold 2/5
2025-04-06 15:39:16,740 - __main__ - ERROR - Error training model for Other: Unknown variable: <Variable path=sequential_11/dense_33/kernel, shape=(8, 16), dtype=float32, value=[[-0.39025807  0.11577618 -0.06645668  0.40738666 -0.3765657   0.46089172
  -0.06446171  0.4594468   0.370484   -0.02104795 -0.1882422  -0.3641199
  -0.0159179  -0.03277779 -0.07332408 -0.4055897 ]
 [-0.05000341  0.4468516  -0.18051493 -0.37137341  0.49092567  0.43102968
  -0.18077922  0.34121346 -0.24667013  0.40383387  0.43888903  0.4376198
   0.4394412   0.46150422 -0.05279791  0.4734515 ]
 [-0.48663068  0.09000933  0.25628364  0.3609084   0.23402202 -0.31649804
  -0.2927556   0.0217061   0.10626173  0.23324299 -0.2312069   0.4780376
  -0.28073072  0.03757    -0.24038088  0.3629923 ]
 [-0.42695713  0.22431874  0.32920575 -0.3882414   0.3486973  -0.2955122
  -0.4718145   0.31428528 -0.1836412   0.2141428   0.07477045 -0.06143963
   0.47815442 -0.36378658 -0.18154311 -0.4448378 ]
 [-0.10068536 -0.36838377  0.43283617 -0.44937074 -0.43967068 -0.36570215
   0.48861754  0.18083096  0.39642978 -0.01604605  0.38632262 -0.0164026
   0.20639288 -0.16161323  0.04906523 -0.0148654 ]
 [-0.3329363  -0.3097098  -0.09154594  0.32676983 -0.01543987 -0.24700594
  -0.17938447 -0.47358406 -0.4375384   0.26490557 -0.2179966   0.18987083
   0.4216702   0.18370342  0.11821389 -0.41357887]
 [-0.4660468   0.395625   -0.25127828 -0.1698736  -0.3311385  -0.05116749
   0.35236108  0.39268517  0.14797533  0.32458007 -0.3696884  -0.08414423
   0.25411224 -0.22976995  0.37321115  0.39204872]
 [-0.03477693  0.38783753  0.10157669 -0.23510933 -0.453578   -0.11239135
  -0.3040645  -0.06203187 -0.27721894  0.30676734  0.09131348  0.27891266
   0.09429979 -0.44027913 -0.36222935 -0.24914372]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:39:16,741 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_11/dense_33/kernel, shape=(8, 16), dtype=float32, value=[[-0.39025807  0.11577618 -0.06645668  0.40738666 -0.3765657   0.46089172
  -0.06446171  0.4594468   0.370484   -0.02104795 -0.1882422  -0.3641199
  -0.0159179  -0.03277779 -0.07332408 -0.4055897 ]
 [-0.05000341  0.4468516  -0.18051493 -0.37137341  0.49092567  0.43102968
  -0.18077922  0.34121346 -0.24667013  0.40383387  0.43888903  0.4376198
   0.4394412   0.46150422 -0.05279791  0.4734515 ]
 [-0.48663068  0.09000933  0.25628364  0.3609084   0.23402202 -0.31649804
  -0.2927556   0.0217061   0.10626173  0.23324299 -0.2312069   0.4780376
  -0.28073072  0.03757    -0.24038088  0.3629923 ]
 [-0.42695713  0.22431874  0.32920575 -0.3882414   0.3486973  -0.2955122
  -0.4718145   0.31428528 -0.1836412   0.2141428   0.07477045 -0.06143963
   0.47815442 -0.36378658 -0.18154311 -0.4448378 ]
 [-0.10068536 -0.36838377  0.43283617 -0.44937074 -0.43967068 -0.36570215
   0.48861754  0.18083096  0.39642978 -0.01604605  0.38632262 -0.0164026
   0.20639288 -0.16161323  0.04906523 -0.0148654 ]
 [-0.3329363  -0.3097098  -0.09154594  0.32676983 -0.01543987 -0.24700594
  -0.17938447 -0.47358406 -0.4375384   0.26490557 -0.2179966   0.18987083
   0.4216702   0.18370342  0.11821389 -0.41357887]
 [-0.4660468   0.395625   -0.25127828 -0.1698736  -0.3311385  -0.05116749
   0.35236108  0.39268517  0.14797533  0.32458007 -0.3696884  -0.08414423
   0.25411224 -0.22976995  0.37321115  0.39204872]
 [-0.03477693  0.38783753  0.10157669 -0.23510933 -0.453578   -0.11239135
  -0.3040645  -0.06203187 -0.27721894  0.30676734  0.09131348  0.27891266
   0.09429979 -0.44027913 -0.36222935 -0.24914372]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:39:16,741 - __main__ - WARNING - Failed to train model for Other
2025-04-06 15:39:16,741 - __main__ - INFO - Processing industry 5/34: Computer Hardware
2025-04-06 15:39:16,742 - __main__ - INFO - Found 137 stocks in Computer Hardware industry
2025-04-06 15:39:20,327 - __main__ - INFO - Saved 2213 records for Computer Hardware to industry_data_from_db\computer_hardware_training.csv
2025-04-06 15:39:20,898 - __main__ - INFO - Training model for Computer Hardware with 2213 records
2025-04-06 15:39:20,898 - __main__ - INFO - Training model for Computer Hardware with 2213 records
2025-04-06 15:39:20,900 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:39:20,900 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:39:20,929 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:39:20,930 - __main__ - INFO - Training fold 1/5
2025-04-06 15:40:26,395 - __main__ - INFO - Training fold 2/5
2025-04-06 15:40:26,453 - __main__ - ERROR - Error training model for Computer Hardware: Unknown variable: <Variable path=sequential_14/dense_42/kernel, shape=(8, 16), dtype=float32, value=[[ 4.69289899e-01 -4.79257345e-01  6.05126619e-02 -4.58660245e-01
   2.70297408e-01 -1.12697005e-01  1.74773097e-01 -3.25529814e-01
   4.21193719e-01  3.93306732e-01 -8.73854160e-02  4.99122381e-01
  -2.88030982e-01 -3.80569220e-01  1.45398736e-01 -4.48464155e-02]
 [-1.99049354e-01 -4.08070683e-01 -3.47443342e-01  1.43156767e-01
   4.19399023e-01  3.62016916e-01 -3.72499466e-01  3.85956883e-01
  -3.83640885e-01 -8.46564770e-03  4.82122779e-01 -2.64644623e-04
   3.64378691e-01  3.37315083e-01  2.62504935e-01 -1.82842135e-01]
 [ 4.90109324e-01  2.69340992e-01  2.81594753e-01  2.08735228e-01
   4.48356390e-01  3.94050121e-01  4.51964736e-01  4.66588020e-01
  -3.19856644e-01 -3.23258042e-01 -4.98120189e-01  4.10197020e-01
   1.35519505e-02  3.57439876e-01 -5.79599142e-02  4.06919956e-01]
 [-2.55805969e-01 -3.97682548e-01 -1.82507634e-01  1.53347969e-01
   3.74789953e-01 -9.00787115e-02  2.14095116e-01 -3.07878017e-01
   6.76935911e-02 -3.94343376e-01 -7.17419386e-02 -2.80151010e-01
  -2.53489137e-01  1.04025602e-01 -2.18947411e-01  6.51594400e-02]
 [ 2.07129359e-01 -3.69912863e-01  3.85890841e-01 -4.86947417e-01
  -1.51923776e-01 -9.92919207e-02  4.63847756e-01 -2.85694599e-01
  -3.54016900e-01  2.59646535e-01  2.64971614e-01  4.60111737e-01
  -1.10235214e-02 -3.94233942e-01 -1.00630641e-01  2.80923009e-01]
 [ 4.62420225e-01 -3.27956557e-01  9.35499668e-02 -1.86251044e-01
  -1.73984647e-01 -6.75441027e-02  4.22278285e-01 -1.22543812e-01
   3.58803391e-01 -3.70261908e-01  3.79475951e-01  1.17028713e-01
  -1.52587414e-01  3.70905757e-01  3.51122141e-01  8.89348984e-02]
 [-3.30487728e-01 -2.50869155e-01 -4.36767101e-01 -2.06402540e-01
   1.06984496e-01 -4.64808583e-01 -8.74114037e-03 -6.59304857e-02
  -7.15296268e-02 -3.03676486e-01 -4.33938503e-02 -4.87483263e-01
  -4.61771369e-01 -1.01429820e-01 -2.87544608e-01 -3.82976770e-01]
 [-3.39882374e-02  3.83577585e-01 -4.41443563e-01 -1.09669328e-01
   4.70875859e-01 -3.69798660e-01 -4.81227279e-01  8.77865553e-02
  -2.28227139e-01 -2.87215590e-01 -3.19656372e-01  3.14652920e-01
  -7.41648674e-03 -1.66378736e-01 -3.18660259e-01 -1.76304817e-01]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:40:26,454 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_14/dense_42/kernel, shape=(8, 16), dtype=float32, value=[[ 4.69289899e-01 -4.79257345e-01  6.05126619e-02 -4.58660245e-01
   2.70297408e-01 -1.12697005e-01  1.74773097e-01 -3.25529814e-01
   4.21193719e-01  3.93306732e-01 -8.73854160e-02  4.99122381e-01
  -2.88030982e-01 -3.80569220e-01  1.45398736e-01 -4.48464155e-02]
 [-1.99049354e-01 -4.08070683e-01 -3.47443342e-01  1.43156767e-01
   4.19399023e-01  3.62016916e-01 -3.72499466e-01  3.85956883e-01
  -3.83640885e-01 -8.46564770e-03  4.82122779e-01 -2.64644623e-04
   3.64378691e-01  3.37315083e-01  2.62504935e-01 -1.82842135e-01]
 [ 4.90109324e-01  2.69340992e-01  2.81594753e-01  2.08735228e-01
   4.48356390e-01  3.94050121e-01  4.51964736e-01  4.66588020e-01
  -3.19856644e-01 -3.23258042e-01 -4.98120189e-01  4.10197020e-01
   1.35519505e-02  3.57439876e-01 -5.79599142e-02  4.06919956e-01]
 [-2.55805969e-01 -3.97682548e-01 -1.82507634e-01  1.53347969e-01
   3.74789953e-01 -9.00787115e-02  2.14095116e-01 -3.07878017e-01
   6.76935911e-02 -3.94343376e-01 -7.17419386e-02 -2.80151010e-01
  -2.53489137e-01  1.04025602e-01 -2.18947411e-01  6.51594400e-02]
 [ 2.07129359e-01 -3.69912863e-01  3.85890841e-01 -4.86947417e-01
  -1.51923776e-01 -9.92919207e-02  4.63847756e-01 -2.85694599e-01
  -3.54016900e-01  2.59646535e-01  2.64971614e-01  4.60111737e-01
  -1.10235214e-02 -3.94233942e-01 -1.00630641e-01  2.80923009e-01]
 [ 4.62420225e-01 -3.27956557e-01  9.35499668e-02 -1.86251044e-01
  -1.73984647e-01 -6.75441027e-02  4.22278285e-01 -1.22543812e-01
   3.58803391e-01 -3.70261908e-01  3.79475951e-01  1.17028713e-01
  -1.52587414e-01  3.70905757e-01  3.51122141e-01  8.89348984e-02]
 [-3.30487728e-01 -2.50869155e-01 -4.36767101e-01 -2.06402540e-01
   1.06984496e-01 -4.64808583e-01 -8.74114037e-03 -6.59304857e-02
  -7.15296268e-02 -3.03676486e-01 -4.33938503e-02 -4.87483263e-01
  -4.61771369e-01 -1.01429820e-01 -2.87544608e-01 -3.82976770e-01]
 [-3.39882374e-02  3.83577585e-01 -4.41443563e-01 -1.09669328e-01
   4.70875859e-01 -3.69798660e-01 -4.81227279e-01  8.77865553e-02
  -2.28227139e-01 -2.87215590e-01 -3.19656372e-01  3.14652920e-01
  -7.41648674e-03 -1.66378736e-01 -3.18660259e-01 -1.76304817e-01]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:40:26,454 - __main__ - WARNING - Failed to train model for Computer Hardware
2025-04-06 15:40:26,455 - __main__ - INFO - Processing industry 6/34: Industrial Equipment
2025-04-06 15:40:26,456 - __main__ - INFO - Found 126 stocks in Industrial Equipment industry
2025-04-06 15:40:29,809 - __main__ - INFO - Saved 2032 records for Industrial Equipment to industry_data_from_db\industrial_equipment_training.csv
2025-04-06 15:40:30,282 - __main__ - INFO - Training model for Industrial Equipment with 2032 records
2025-04-06 15:40:30,282 - __main__ - INFO - Training model for Industrial Equipment with 2032 records
2025-04-06 15:40:30,283 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:40:30,283 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:40:30,311 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:40:30,311 - __main__ - INFO - Training fold 1/5
2025-04-06 15:41:22,627 - __main__ - INFO - Training fold 2/5
2025-04-06 15:41:22,678 - __main__ - ERROR - Error training model for Industrial Equipment: Unknown variable: <Variable path=sequential_17/dense_51/kernel, shape=(8, 16), dtype=float32, value=[[-0.45221782 -0.2834257  -0.1768353  -0.24954188 -0.29340315  0.14347148
   0.30537868 -0.3361267   0.2461251   0.05294704 -0.4475839   0.03464818
   0.19021642 -0.1335721   0.02344632  0.34695554]
 [-0.46004438  0.2090168  -0.38481665  0.16626763  0.4171939  -0.16729951
  -0.00434661  0.25040734  0.3213415  -0.16570401  0.25716972  0.34151816
   0.13182831 -0.37213886  0.02907634 -0.17521226]
 [ 0.35924792 -0.35014653  0.17290199 -0.21335268  0.3232757   0.1052953
  -0.23254275 -0.20237494 -0.07006025 -0.40249932 -0.06382728 -0.40843952
  -0.4922198  -0.36279535 -0.4003564   0.11752462]
 [-0.15155411 -0.0706526   0.10908425  0.36036515 -0.4418422   0.38496172
  -0.28779256  0.27302396  0.06039655 -0.47707498  0.42049468  0.25515175
  -0.06983066  0.4183544   0.3026458   0.17845154]
 [ 0.08766842 -0.21244943  0.04902732 -0.13823867 -0.34806395  0.03890765
  -0.2536682   0.39094555 -0.43905365  0.46056843 -0.26050174 -0.25189817
  -0.4879818  -0.44301462  0.47836125  0.03446555]
 [-0.2543341  -0.08908904  0.17902243  0.30255008  0.10090339  0.21405339
   0.14919388  0.3253019   0.38907862  0.14132476 -0.30646467 -0.23571837
  -0.42345393  0.06650019  0.46502173 -0.4961791 ]
 [-0.13265204  0.01653421  0.16022742 -0.37782168  0.374115   -0.49165785
   0.49452424  0.40283453  0.3301896  -0.4065311  -0.1099925   0.31744397
   0.19994128  0.34266663  0.48106623 -0.17686915]
 [ 0.17596948  0.11866009 -0.10444283  0.11801875 -0.43228078 -0.32303715
   0.1906389  -0.10006678  0.10870969  0.2559724   0.2357564  -0.23472273
  -0.13951695  0.12725043 -0.3135922   0.07742047]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:41:22,679 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_17/dense_51/kernel, shape=(8, 16), dtype=float32, value=[[-0.45221782 -0.2834257  -0.1768353  -0.24954188 -0.29340315  0.14347148
   0.30537868 -0.3361267   0.2461251   0.05294704 -0.4475839   0.03464818
   0.19021642 -0.1335721   0.02344632  0.34695554]
 [-0.46004438  0.2090168  -0.38481665  0.16626763  0.4171939  -0.16729951
  -0.00434661  0.25040734  0.3213415  -0.16570401  0.25716972  0.34151816
   0.13182831 -0.37213886  0.02907634 -0.17521226]
 [ 0.35924792 -0.35014653  0.17290199 -0.21335268  0.3232757   0.1052953
  -0.23254275 -0.20237494 -0.07006025 -0.40249932 -0.06382728 -0.40843952
  -0.4922198  -0.36279535 -0.4003564   0.11752462]
 [-0.15155411 -0.0706526   0.10908425  0.36036515 -0.4418422   0.38496172
  -0.28779256  0.27302396  0.06039655 -0.47707498  0.42049468  0.25515175
  -0.06983066  0.4183544   0.3026458   0.17845154]
 [ 0.08766842 -0.21244943  0.04902732 -0.13823867 -0.34806395  0.03890765
  -0.2536682   0.39094555 -0.43905365  0.46056843 -0.26050174 -0.25189817
  -0.4879818  -0.44301462  0.47836125  0.03446555]
 [-0.2543341  -0.08908904  0.17902243  0.30255008  0.10090339  0.21405339
   0.14919388  0.3253019   0.38907862  0.14132476 -0.30646467 -0.23571837
  -0.42345393  0.06650019  0.46502173 -0.4961791 ]
 [-0.13265204  0.01653421  0.16022742 -0.37782168  0.374115   -0.49165785
   0.49452424  0.40283453  0.3301896  -0.4065311  -0.1099925   0.31744397
   0.19994128  0.34266663  0.48106623 -0.17686915]
 [ 0.17596948  0.11866009 -0.10444283  0.11801875 -0.43228078 -0.32303715
   0.1906389  -0.10006678  0.10870969  0.2559724   0.2357564  -0.23472273
  -0.13951695  0.12725043 -0.3135922   0.07742047]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:41:22,679 - __main__ - WARNING - Failed to train model for Industrial Equipment
2025-04-06 15:41:22,679 - __main__ - INFO - Processing industry 7/34: Semiconductors
2025-04-06 15:41:22,681 - __main__ - INFO - Found 125 stocks in Semiconductors industry
2025-04-06 15:41:25,835 - __main__ - INFO - Saved 1905 records for Semiconductors to industry_data_from_db\semiconductors_training.csv
2025-04-06 15:41:26,522 - __main__ - INFO - Training model for Semiconductors with 1905 records
2025-04-06 15:41:26,522 - __main__ - INFO - Training model for Semiconductors with 1905 records
2025-04-06 15:41:26,522 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:41:26,523 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:41:26,548 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:41:26,548 - __main__ - INFO - Training fold 1/5
2025-04-06 15:42:23,343 - __main__ - INFO - Training fold 2/5
2025-04-06 15:42:23,407 - __main__ - ERROR - Error training model for Semiconductors: Unknown variable: <Variable path=sequential_20/dense_60/kernel, shape=(8, 16), dtype=float32, value=[[ 8.96559954e-02  4.12678957e-01 -1.72678471e-01 -4.64462161e-01
  -4.39890027e-01 -3.07503819e-01  7.16571808e-02  1.30840778e-01
  -3.49103212e-02 -4.20476913e-01  2.46507764e-01 -2.19288230e-01
  -3.99668813e-01 -3.07289720e-01  9.82605219e-02 -9.48727131e-02]
 [-2.39008069e-01  4.20387030e-01  4.16360378e-01 -1.74349308e-01
   9.48164463e-02  1.52453065e-01 -9.49420929e-02  3.21379900e-02
  -4.58998561e-01 -4.18319702e-02 -1.23725414e-01 -4.67464447e-01
  -1.19577527e-01 -5.70777655e-02  5.80549240e-02 -2.43411064e-02]
 [-4.80788469e-01  3.08417320e-01  4.30639386e-01  4.14849281e-01
  -3.21030617e-04 -2.52645850e-01 -3.55830550e-01 -1.45532131e-01
  -3.77115488e-01  3.94821405e-01 -4.06136870e-01  1.74650431e-01
  -1.99290395e-01 -2.24009752e-02 -2.23590851e-01  4.71348882e-01]
 [-2.54116058e-02 -2.42967606e-01  4.26513672e-01  1.28056288e-01
  -4.63101864e-02 -4.68090057e-01  9.10103321e-03  3.65561962e-01
   4.62668896e-01 -3.36375237e-01 -9.78763103e-02  2.97756314e-01
   9.90449190e-02  2.39589334e-01 -3.39662552e-01 -3.44661593e-01]
 [ 4.45317030e-01  3.55619311e-01  4.85377431e-01 -4.34214354e-01
  -3.10729861e-01 -2.67764330e-01 -1.09017372e-01 -2.17560053e-01
  -1.91202998e-01  4.10057187e-01 -4.55825329e-01  1.73138261e-01
   1.82355642e-01 -2.17358947e-01 -7.29990005e-03  4.96516347e-01]
 [ 2.93982387e-01  6.47902489e-03 -4.74385023e-02 -5.77844381e-02
   6.90610409e-02 -3.48916173e-01  2.77601242e-01 -8.17943811e-02
   4.36233282e-01  2.60885239e-01  2.75918245e-01  1.83493733e-01
   8.86383057e-02  3.77553701e-01 -7.78619051e-02  4.55246091e-01]
 [ 3.56532335e-02 -2.92943716e-02 -3.33795428e-01  4.60588932e-02
   6.73345327e-02 -6.84319735e-02 -3.81837606e-01 -3.91653538e-01
  -4.92284536e-01  2.72434473e-01  6.38414621e-02 -1.62058473e-01
  -4.72039104e-01  1.24418736e-03  1.65420294e-01  4.14749026e-01]
 [ 6.58607483e-03 -3.01764011e-01  3.04014802e-01 -4.68661427e-01
  -4.48063731e-01  4.39370632e-01  1.67831779e-01  2.31350422e-01
  -2.13905692e-01  3.59493375e-01  4.08152223e-01 -3.09408903e-01
   2.61224627e-01 -4.43745494e-01 -2.50614762e-01  3.94790888e-01]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:42:23,408 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_20/dense_60/kernel, shape=(8, 16), dtype=float32, value=[[ 8.96559954e-02  4.12678957e-01 -1.72678471e-01 -4.64462161e-01
  -4.39890027e-01 -3.07503819e-01  7.16571808e-02  1.30840778e-01
  -3.49103212e-02 -4.20476913e-01  2.46507764e-01 -2.19288230e-01
  -3.99668813e-01 -3.07289720e-01  9.82605219e-02 -9.48727131e-02]
 [-2.39008069e-01  4.20387030e-01  4.16360378e-01 -1.74349308e-01
   9.48164463e-02  1.52453065e-01 -9.49420929e-02  3.21379900e-02
  -4.58998561e-01 -4.18319702e-02 -1.23725414e-01 -4.67464447e-01
  -1.19577527e-01 -5.70777655e-02  5.80549240e-02 -2.43411064e-02]
 [-4.80788469e-01  3.08417320e-01  4.30639386e-01  4.14849281e-01
  -3.21030617e-04 -2.52645850e-01 -3.55830550e-01 -1.45532131e-01
  -3.77115488e-01  3.94821405e-01 -4.06136870e-01  1.74650431e-01
  -1.99290395e-01 -2.24009752e-02 -2.23590851e-01  4.71348882e-01]
 [-2.54116058e-02 -2.42967606e-01  4.26513672e-01  1.28056288e-01
  -4.63101864e-02 -4.68090057e-01  9.10103321e-03  3.65561962e-01
   4.62668896e-01 -3.36375237e-01 -9.78763103e-02  2.97756314e-01
   9.90449190e-02  2.39589334e-01 -3.39662552e-01 -3.44661593e-01]
 [ 4.45317030e-01  3.55619311e-01  4.85377431e-01 -4.34214354e-01
  -3.10729861e-01 -2.67764330e-01 -1.09017372e-01 -2.17560053e-01
  -1.91202998e-01  4.10057187e-01 -4.55825329e-01  1.73138261e-01
   1.82355642e-01 -2.17358947e-01 -7.29990005e-03  4.96516347e-01]
 [ 2.93982387e-01  6.47902489e-03 -4.74385023e-02 -5.77844381e-02
   6.90610409e-02 -3.48916173e-01  2.77601242e-01 -8.17943811e-02
   4.36233282e-01  2.60885239e-01  2.75918245e-01  1.83493733e-01
   8.86383057e-02  3.77553701e-01 -7.78619051e-02  4.55246091e-01]
 [ 3.56532335e-02 -2.92943716e-02 -3.33795428e-01  4.60588932e-02
   6.73345327e-02 -6.84319735e-02 -3.81837606e-01 -3.91653538e-01
  -4.92284536e-01  2.72434473e-01  6.38414621e-02 -1.62058473e-01
  -4.72039104e-01  1.24418736e-03  1.65420294e-01  4.14749026e-01]
 [ 6.58607483e-03 -3.01764011e-01  3.04014802e-01 -4.68661427e-01
  -4.48063731e-01  4.39370632e-01  1.67831779e-01  2.31350422e-01
  -2.13905692e-01  3.59493375e-01  4.08152223e-01 -3.09408903e-01
   2.61224627e-01 -4.43745494e-01 -2.50614762e-01  3.94790888e-01]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:42:23,408 - __main__ - WARNING - Failed to train model for Semiconductors
2025-04-06 15:42:23,408 - __main__ - INFO - Processing industry 8/34: Financial Services
2025-04-06 15:42:23,409 - __main__ - INFO - Found 82 stocks in Financial Services industry
2025-04-06 15:42:25,022 - __main__ - INFO - Saved 204 records for Financial Services to industry_data_from_db\financial_services_training.csv
2025-04-06 15:42:25,540 - __main__ - INFO - Training model for Financial Services with 204 records
2025-04-06 15:42:25,540 - __main__ - INFO - Training model for Financial Services with 204 records
2025-04-06 15:42:25,540 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'revenue_growth']
2025-04-06 15:42:25,541 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:42:25,565 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:42:25,566 - __main__ - INFO - Training fold 1/5
2025-04-06 15:42:35,766 - __main__ - INFO - Training fold 2/5
2025-04-06 15:42:35,817 - __main__ - ERROR - Error training model for Financial Services: Unknown variable: <Variable path=sequential_23/dense_69/kernel, shape=(6, 16), dtype=float32, value=[[ 0.429276    0.20192492 -0.3660965  -0.43741795 -0.48664165 -0.11460814
  -0.3346054  -0.13546741 -0.15952674  0.25369728 -0.5050284  -0.3960997
   0.16307318  0.24219304  0.1341176   0.15348488]
 [ 0.3639542  -0.42632362  0.25572306 -0.13689741  0.4338252  -0.42112795
   0.05535889 -0.4103882  -0.15355486  0.32953537  0.3355776   0.02982026
  -0.44302326  0.21610624 -0.17284659  0.03275508]
 [ 0.06171626 -0.36998308  0.17133701 -0.5085449  -0.20145077 -0.4370767
  -0.19563702 -0.3922695  -0.38033172  0.06956142 -0.45504695 -0.51399225
   0.02113032 -0.29393506  0.2102691   0.17450815]
 [-0.17353812  0.378695   -0.41729563  0.3045209  -0.5198877  -0.50654393
   0.35234326  0.17651105  0.07614934  0.1058262  -0.374891    0.19284648
   0.40487188  0.27264202 -0.15616497 -0.46833444]
 [-0.02725226  0.47068083  0.14818174 -0.13669384  0.4394923  -0.13767338
   0.45164275 -0.5180358  -0.3315929  -0.20775184 -0.21672055 -0.19061291
   0.2943446  -0.50340676  0.03103673 -0.3066966 ]
 [ 0.4994145  -0.08191863  0.0476591  -0.14915967  0.31153506  0.29712176
   0.3907038   0.2701788  -0.2775817  -0.05275178 -0.03659961  0.13134253
   0.47815043  0.37467027  0.07976896 -0.43535843]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:42:35,818 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_23/dense_69/kernel, shape=(6, 16), dtype=float32, value=[[ 0.429276    0.20192492 -0.3660965  -0.43741795 -0.48664165 -0.11460814
  -0.3346054  -0.13546741 -0.15952674  0.25369728 -0.5050284  -0.3960997
   0.16307318  0.24219304  0.1341176   0.15348488]
 [ 0.3639542  -0.42632362  0.25572306 -0.13689741  0.4338252  -0.42112795
   0.05535889 -0.4103882  -0.15355486  0.32953537  0.3355776   0.02982026
  -0.44302326  0.21610624 -0.17284659  0.03275508]
 [ 0.06171626 -0.36998308  0.17133701 -0.5085449  -0.20145077 -0.4370767
  -0.19563702 -0.3922695  -0.38033172  0.06956142 -0.45504695 -0.51399225
   0.02113032 -0.29393506  0.2102691   0.17450815]
 [-0.17353812  0.378695   -0.41729563  0.3045209  -0.5198877  -0.50654393
   0.35234326  0.17651105  0.07614934  0.1058262  -0.374891    0.19284648
   0.40487188  0.27264202 -0.15616497 -0.46833444]
 [-0.02725226  0.47068083  0.14818174 -0.13669384  0.4394923  -0.13767338
   0.45164275 -0.5180358  -0.3315929  -0.20775184 -0.21672055 -0.19061291
   0.2943446  -0.50340676  0.03103673 -0.3066966 ]
 [ 0.4994145  -0.08191863  0.0476591  -0.14915967  0.31153506  0.29712176
   0.3907038   0.2701788  -0.2775817  -0.05275178 -0.03659961  0.13134253
   0.47815043  0.37467027  0.07976896 -0.43535843]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:42:35,818 - __main__ - WARNING - Failed to train model for Financial Services
2025-04-06 15:42:35,818 - __main__ - INFO - Processing industry 9/34: Construction
2025-04-06 15:42:35,820 - __main__ - INFO - Found 80 stocks in Construction industry
2025-04-06 15:42:38,131 - __main__ - INFO - Saved 1462 records for Construction to industry_data_from_db\construction_training.csv
2025-04-06 15:42:52,255 - __main__ - INFO - Training model for Construction with 1462 records
2025-04-06 15:42:52,255 - __main__ - INFO - Training model for Construction with 1462 records
2025-04-06 15:42:52,255 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:42:52,256 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:42:52,284 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:42:52,285 - __main__ - INFO - Training fold 1/5
2025-04-06 15:43:15,535 - __main__ - INFO - Training fold 2/5
2025-04-06 15:43:15,586 - __main__ - ERROR - Error training model for Construction: Unknown variable: <Variable path=sequential_26/dense_78/kernel, shape=(8, 16), dtype=float32, value=[[-0.22598863  0.24297643  0.18291724  0.38982034 -0.24539101 -0.44571304
   0.2396115  -0.11627531 -0.03432679 -0.08259356  0.25833082  0.3518647
  -0.02244925 -0.26429725  0.05117106 -0.378533  ]
 [-0.27546787  0.27301538  0.20000124  0.2639966   0.10565901 -0.4105327
   0.02272892 -0.4691676  -0.43831372 -0.19173038 -0.29333532  0.49884295
  -0.42742622  0.18565476  0.11167431  0.4973197 ]
 [-0.15079856  0.16327679 -0.02374971  0.4797181   0.1256293   0.03950167
   0.36165607  0.28818023  0.27615142  0.18382454 -0.43299115 -0.43606174
   0.40247166 -0.20019007  0.06887627 -0.24405563]
 [ 0.2474351   0.3793037   0.12591732  0.26550674 -0.49466515  0.30044055
  -0.38214827  0.15788043 -0.18949687 -0.39060676 -0.06571329 -0.46794033
  -0.13512099 -0.36464572 -0.11383688  0.3978722 ]
 [-0.4955169  -0.19876802 -0.38256502 -0.13683558  0.13067496  0.0546037
  -0.01751399  0.31990492 -0.36010003  0.15907276 -0.22066414  0.30882263
  -0.3134507  -0.3925562   0.20367086 -0.41268575]
 [ 0.26254153 -0.00412059 -0.21400678 -0.33972347 -0.2532587  -0.2756462
   0.09093308 -0.03528452  0.19652677  0.14237547  0.2759571  -0.4968586
  -0.0083437   0.28873503 -0.31479824 -0.05267584]
 [ 0.18947649 -0.17628908 -0.36119807  0.12084651  0.3273821  -0.30877066
   0.11731863 -0.09664118  0.23561203 -0.45014584 -0.12450671  0.4433837
  -0.18480837  0.43994856  0.39569962 -0.42303705]
 [-0.25137007 -0.41047513  0.17380655 -0.02457714  0.39769638  0.19725394
  -0.3339002  -0.41300285 -0.41229832 -0.21554494 -0.42700112 -0.48221254
  -0.2047025   0.42489386  0.34782612 -0.35810637]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:43:15,597 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_26/dense_78/kernel, shape=(8, 16), dtype=float32, value=[[-0.22598863  0.24297643  0.18291724  0.38982034 -0.24539101 -0.44571304
   0.2396115  -0.11627531 -0.03432679 -0.08259356  0.25833082  0.3518647
  -0.02244925 -0.26429725  0.05117106 -0.378533  ]
 [-0.27546787  0.27301538  0.20000124  0.2639966   0.10565901 -0.4105327
   0.02272892 -0.4691676  -0.43831372 -0.19173038 -0.29333532  0.49884295
  -0.42742622  0.18565476  0.11167431  0.4973197 ]
 [-0.15079856  0.16327679 -0.02374971  0.4797181   0.1256293   0.03950167
   0.36165607  0.28818023  0.27615142  0.18382454 -0.43299115 -0.43606174
   0.40247166 -0.20019007  0.06887627 -0.24405563]
 [ 0.2474351   0.3793037   0.12591732  0.26550674 -0.49466515  0.30044055
  -0.38214827  0.15788043 -0.18949687 -0.39060676 -0.06571329 -0.46794033
  -0.13512099 -0.36464572 -0.11383688  0.3978722 ]
 [-0.4955169  -0.19876802 -0.38256502 -0.13683558  0.13067496  0.0546037
  -0.01751399  0.31990492 -0.36010003  0.15907276 -0.22066414  0.30882263
  -0.3134507  -0.3925562   0.20367086 -0.41268575]
 [ 0.26254153 -0.00412059 -0.21400678 -0.33972347 -0.2532587  -0.2756462
   0.09093308 -0.03528452  0.19652677  0.14237547  0.2759571  -0.4968586
  -0.0083437   0.28873503 -0.31479824 -0.05267584]
 [ 0.18947649 -0.17628908 -0.36119807  0.12084651  0.3273821  -0.30877066
   0.11731863 -0.09664118  0.23561203 -0.45014584 -0.12450671  0.4433837
  -0.18480837  0.43994856  0.39569962 -0.42303705]
 [-0.25137007 -0.41047513  0.17380655 -0.02457714  0.39769638  0.19725394
  -0.3339002  -0.41300285 -0.41229832 -0.21554494 -0.42700112 -0.48221254
  -0.2047025   0.42489386  0.34782612 -0.35810637]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:43:15,597 - __main__ - WARNING - Failed to train model for Construction
2025-04-06 15:43:15,597 - __main__ - INFO - Processing industry 10/34: Tourism & Hospitality
2025-04-06 15:43:15,599 - __main__ - INFO - Found 64 stocks in Tourism & Hospitality industry
2025-04-06 15:43:17,054 - __main__ - INFO - Saved 954 records for Tourism & Hospitality to industry_data_from_db\tourism_&_hospitality_training.csv
2025-04-06 15:43:17,640 - __main__ - INFO - Training model for Tourism & Hospitality with 954 records
2025-04-06 15:43:17,641 - __main__ - INFO - Training model for Tourism & Hospitality with 954 records
2025-04-06 15:43:17,641 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:43:17,641 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:43:17,670 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:43:17,670 - __main__ - INFO - Training fold 1/5
2025-04-06 15:43:49,230 - __main__ - INFO - Training fold 2/5
2025-04-06 15:43:49,280 - __main__ - ERROR - Error training model for Tourism & Hospitality: Unknown variable: <Variable path=sequential_29/dense_87/kernel, shape=(8, 16), dtype=float32, value=[[ 0.12995803 -0.19961643 -0.34699857 -0.2865466  -0.49512208  0.00924134
   0.16185474  0.2649051   0.25276065  0.4499302   0.04471838  0.20248699
   0.13372743  0.06082571 -0.02035344 -0.08723342]
 [-0.37750733  0.18148673  0.4834125   0.22885919  0.17472327  0.46879053
  -0.09666002  0.11405003  0.48192942 -0.10940182 -0.3380835   0.37551093
   0.36174822 -0.04591417  0.34573185 -0.36519444]
 [-0.06432903  0.47191012 -0.38289392 -0.03753734  0.4945215   0.46601355
  -0.446558    0.40851188  0.28060246  0.12443924 -0.47120023 -0.0024153
   0.20033395 -0.04883122  0.22377932  0.41608405]
 [-0.3883263   0.38964272  0.45429075  0.29778457  0.3692664  -0.4984349
   0.02537704  0.018978    0.2309345  -0.215114   -0.3761059   0.23188841
  -0.11934733 -0.13558233 -0.00731552 -0.426067  ]
 [-0.01133633  0.17367351 -0.19906485  0.14371777  0.08704579  0.40222788
  -0.01062727 -0.10367548 -0.22572792 -0.19364834  0.2826177   0.07449543
  -0.38719773  0.14862823  0.13795018 -0.32065117]
 [ 0.33938158  0.06626177  0.10419977 -0.24468803 -0.23068047  0.1648699
  -0.05293882  0.17392194 -0.16810739  0.35249496  0.10173404 -0.37642705
  -0.4116751   0.3830979   0.24572074  0.44867384]
 [-0.18341279  0.36522102 -0.02979136  0.07464004  0.28317153  0.00293136
  -0.25365114 -0.24977374  0.11706281 -0.21466577  0.14817333 -0.47034037
  -0.2664466  -0.01525605  0.47843647  0.3507967 ]
 [-0.403749   -0.293414    0.17893815  0.22556591 -0.25074458  0.10791695
   0.4420426  -0.03967714 -0.44232774  0.4199288   0.39070117 -0.47140002
  -0.32951128 -0.00946772  0.1285212   0.22549951]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:43:49,280 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_29/dense_87/kernel, shape=(8, 16), dtype=float32, value=[[ 0.12995803 -0.19961643 -0.34699857 -0.2865466  -0.49512208  0.00924134
   0.16185474  0.2649051   0.25276065  0.4499302   0.04471838  0.20248699
   0.13372743  0.06082571 -0.02035344 -0.08723342]
 [-0.37750733  0.18148673  0.4834125   0.22885919  0.17472327  0.46879053
  -0.09666002  0.11405003  0.48192942 -0.10940182 -0.3380835   0.37551093
   0.36174822 -0.04591417  0.34573185 -0.36519444]
 [-0.06432903  0.47191012 -0.38289392 -0.03753734  0.4945215   0.46601355
  -0.446558    0.40851188  0.28060246  0.12443924 -0.47120023 -0.0024153
   0.20033395 -0.04883122  0.22377932  0.41608405]
 [-0.3883263   0.38964272  0.45429075  0.29778457  0.3692664  -0.4984349
   0.02537704  0.018978    0.2309345  -0.215114   -0.3761059   0.23188841
  -0.11934733 -0.13558233 -0.00731552 -0.426067  ]
 [-0.01133633  0.17367351 -0.19906485  0.14371777  0.08704579  0.40222788
  -0.01062727 -0.10367548 -0.22572792 -0.19364834  0.2826177   0.07449543
  -0.38719773  0.14862823  0.13795018 -0.32065117]
 [ 0.33938158  0.06626177  0.10419977 -0.24468803 -0.23068047  0.1648699
  -0.05293882  0.17392194 -0.16810739  0.35249496  0.10173404 -0.37642705
  -0.4116751   0.3830979   0.24572074  0.44867384]
 [-0.18341279  0.36522102 -0.02979136  0.07464004  0.28317153  0.00293136
  -0.25365114 -0.24977374  0.11706281 -0.21466577  0.14817333 -0.47034037
  -0.2664466  -0.01525605  0.47843647  0.3507967 ]
 [-0.403749   -0.293414    0.17893815  0.22556591 -0.25074458  0.10791695
   0.4420426  -0.03967714 -0.44232774  0.4199288   0.39070117 -0.47140002
  -0.32951128 -0.00946772  0.1285212   0.22549951]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:43:49,281 - __main__ - WARNING - Failed to train model for Tourism & Hospitality
2025-04-06 15:43:49,281 - __main__ - INFO - Processing industry 11/34: Textiles
2025-04-06 15:43:49,281 - __main__ - INFO - Found 59 stocks in Textiles industry
2025-04-06 15:43:50,972 - __main__ - INFO - Saved 1049 records for Textiles to industry_data_from_db\textiles_training.csv
2025-04-06 15:43:56,833 - __main__ - INFO - Training model for Textiles with 1049 records
2025-04-06 15:43:56,833 - __main__ - INFO - Training model for Textiles with 1049 records
2025-04-06 15:43:56,833 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:43:56,834 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:43:56,863 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:43:56,864 - __main__ - INFO - Training fold 1/5
2025-04-06 15:44:32,502 - __main__ - INFO - Training fold 2/5
2025-04-06 15:44:32,554 - __main__ - ERROR - Error training model for Textiles: Unknown variable: <Variable path=sequential_32/dense_96/kernel, shape=(8, 16), dtype=float32, value=[[-0.19409609  0.21037519 -0.16986322 -0.13026273 -0.43245494 -0.3988948
   0.04458082 -0.4776286   0.24660909 -0.32056713 -0.08569419  0.27422464
  -0.2675135  -0.4289435   0.24508238 -0.3058231 ]
 [ 0.27886093 -0.33933198 -0.28061533  0.06886399  0.35682857 -0.1011914
   0.362455   -0.18193853 -0.24327135 -0.01193333 -0.07642961  0.34893692
  -0.16152847 -0.05657661 -0.33168256 -0.4658301 ]
 [-0.28674746 -0.49086702 -0.17485905 -0.16070056 -0.25477672 -0.38704753
   0.3767469   0.0525949   0.36600566  0.46750915 -0.37403774  0.29734337
   0.10419655  0.07532561  0.25190508 -0.085356  ]
 [-0.16162896  0.34534073 -0.46486926 -0.02636456  0.03862071 -0.30893314
   0.31144285  0.31958377  0.32650077 -0.20601678  0.46636784  0.05431855
   0.4349028   0.4627446  -0.39198995  0.14412844]
 [-0.37763608 -0.43943202  0.12695277  0.3538015  -0.24165678 -0.09190917
  -0.14805782  0.09852934  0.23757374 -0.01246083 -0.20643497 -0.4370792
   0.37322044  0.1725657  -0.29620934  0.35877538]
 [-0.18190861 -0.09606934  0.20995116  0.00751173  0.09893429 -0.28385007
  -0.24984741  0.08173251 -0.38350606 -0.06087661  0.29510367 -0.11145079
  -0.24939919 -0.44065654 -0.36026502  0.20179248]
 [-0.1369803  -0.3177029   0.0839802   0.28140283 -0.47037005 -0.22369015
   0.400998   -0.08371711 -0.1244719   0.19638169  0.44841397  0.4257295
  -0.12712908 -0.41197503 -0.11330748 -0.26180577]
 [-0.0124352  -0.3073324   0.252599    0.16408205  0.25474298 -0.08270812
   0.18398964 -0.4938228  -0.01122332 -0.16086078  0.29750085  0.08573341
  -0.29728925  0.40042448  0.24725354 -0.08144391]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:44:32,555 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_32/dense_96/kernel, shape=(8, 16), dtype=float32, value=[[-0.19409609  0.21037519 -0.16986322 -0.13026273 -0.43245494 -0.3988948
   0.04458082 -0.4776286   0.24660909 -0.32056713 -0.08569419  0.27422464
  -0.2675135  -0.4289435   0.24508238 -0.3058231 ]
 [ 0.27886093 -0.33933198 -0.28061533  0.06886399  0.35682857 -0.1011914
   0.362455   -0.18193853 -0.24327135 -0.01193333 -0.07642961  0.34893692
  -0.16152847 -0.05657661 -0.33168256 -0.4658301 ]
 [-0.28674746 -0.49086702 -0.17485905 -0.16070056 -0.25477672 -0.38704753
   0.3767469   0.0525949   0.36600566  0.46750915 -0.37403774  0.29734337
   0.10419655  0.07532561  0.25190508 -0.085356  ]
 [-0.16162896  0.34534073 -0.46486926 -0.02636456  0.03862071 -0.30893314
   0.31144285  0.31958377  0.32650077 -0.20601678  0.46636784  0.05431855
   0.4349028   0.4627446  -0.39198995  0.14412844]
 [-0.37763608 -0.43943202  0.12695277  0.3538015  -0.24165678 -0.09190917
  -0.14805782  0.09852934  0.23757374 -0.01246083 -0.20643497 -0.4370792
   0.37322044  0.1725657  -0.29620934  0.35877538]
 [-0.18190861 -0.09606934  0.20995116  0.00751173  0.09893429 -0.28385007
  -0.24984741  0.08173251 -0.38350606 -0.06087661  0.29510367 -0.11145079
  -0.24939919 -0.44065654 -0.36026502  0.20179248]
 [-0.1369803  -0.3177029   0.0839802   0.28140283 -0.47037005 -0.22369015
   0.400998   -0.08371711 -0.1244719   0.19638169  0.44841397  0.4257295
  -0.12712908 -0.41197503 -0.11330748 -0.26180577]
 [-0.0124352  -0.3073324   0.252599    0.16408205  0.25474298 -0.08270812
   0.18398964 -0.4938228  -0.01122332 -0.16086078  0.29750085  0.08573341
  -0.29728925  0.40042448  0.24725354 -0.08144391]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:44:32,555 - __main__ - WARNING - Failed to train model for Textiles
2025-04-06 15:44:32,556 - __main__ - INFO - Processing industry 12/34: Green Energy
2025-04-06 15:44:32,557 - __main__ - INFO - Found 56 stocks in Green Energy industry
2025-04-06 15:44:33,525 - __main__ - INFO - Saved 626 records for Green Energy to industry_data_from_db\green_energy_training.csv
2025-04-06 15:44:34,511 - __main__ - INFO - Training model for Green Energy with 626 records
2025-04-06 15:44:34,512 - __main__ - INFO - Training model for Green Energy with 626 records
2025-04-06 15:44:34,512 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:44:34,513 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:44:34,541 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:44:34,542 - __main__ - INFO - Training fold 1/5
2025-04-06 15:44:53,614 - __main__ - INFO - Training fold 2/5
2025-04-06 15:44:53,665 - __main__ - ERROR - Error training model for Green Energy: Unknown variable: <Variable path=sequential_35/dense_105/kernel, shape=(8, 16), dtype=float32, value=[[-0.43464744 -0.29350448 -0.09452939 -0.24973989 -0.39531338  0.25387096
  -0.06560218 -0.20989263 -0.19977224 -0.19886434  0.20969331 -0.05926907
   0.21046627 -0.22074234 -0.06489468 -0.0807085 ]
 [-0.3348472   0.3339883  -0.32720673  0.26565146 -0.10665751 -0.19637501
   0.20679164 -0.44726884  0.02708471  0.06998491 -0.4647566  -0.31942427
   0.37675095  0.46941054 -0.32581174  0.20914471]
 [ 0.16568422 -0.2966442  -0.43317342 -0.42161584 -0.0693872  -0.21389925
  -0.10464513  0.43503678  0.07686043 -0.26273715 -0.45662534 -0.12428701
  -0.02602851 -0.28506577  0.17322063 -0.31207538]
 [ 0.46018124 -0.25995755  0.30905104  0.46098268  0.40959048  0.3566296
   0.43485653  0.18280351 -0.02087617  0.34189427 -0.30632544  0.04714477
  -0.25087893 -0.16523695 -0.42277944 -0.2321819 ]
 [ 0.47750485 -0.04539025  0.36568868  0.35271943  0.16083753  0.45656943
  -0.01987338  0.19386709  0.2749443  -0.3371054  -0.26842833 -0.10120273
   0.13225067 -0.04427087  0.10028493 -0.34420228]
 [-0.25233805  0.13558364 -0.16993606  0.38595116  0.43968272 -0.4696858
  -0.07244229  0.05521619  0.49573326  0.3966421  -0.18583655  0.19382644
   0.08072007 -0.23080587 -0.27483392  0.23421323]
 [-0.26697552  0.4480101   0.11724567 -0.12561119  0.02916038 -0.03143287
  -0.066679    0.29153156  0.39346075  0.37593222  0.45092857  0.12604153
   0.27737713 -0.14077675  0.33198702  0.18105698]
 [-0.49110103  0.19081533  0.3353871   0.0374155  -0.1608069  -0.49326098
   0.2697295  -0.07608783  0.45718455 -0.42017317 -0.463897    0.4719684
   0.01884913  0.20699263 -0.33571565  0.4935683 ]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:44:53,665 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_35/dense_105/kernel, shape=(8, 16), dtype=float32, value=[[-0.43464744 -0.29350448 -0.09452939 -0.24973989 -0.39531338  0.25387096
  -0.06560218 -0.20989263 -0.19977224 -0.19886434  0.20969331 -0.05926907
   0.21046627 -0.22074234 -0.06489468 -0.0807085 ]
 [-0.3348472   0.3339883  -0.32720673  0.26565146 -0.10665751 -0.19637501
   0.20679164 -0.44726884  0.02708471  0.06998491 -0.4647566  -0.31942427
   0.37675095  0.46941054 -0.32581174  0.20914471]
 [ 0.16568422 -0.2966442  -0.43317342 -0.42161584 -0.0693872  -0.21389925
  -0.10464513  0.43503678  0.07686043 -0.26273715 -0.45662534 -0.12428701
  -0.02602851 -0.28506577  0.17322063 -0.31207538]
 [ 0.46018124 -0.25995755  0.30905104  0.46098268  0.40959048  0.3566296
   0.43485653  0.18280351 -0.02087617  0.34189427 -0.30632544  0.04714477
  -0.25087893 -0.16523695 -0.42277944 -0.2321819 ]
 [ 0.47750485 -0.04539025  0.36568868  0.35271943  0.16083753  0.45656943
  -0.01987338  0.19386709  0.2749443  -0.3371054  -0.26842833 -0.10120273
   0.13225067 -0.04427087  0.10028493 -0.34420228]
 [-0.25233805  0.13558364 -0.16993606  0.38595116  0.43968272 -0.4696858
  -0.07244229  0.05521619  0.49573326  0.3966421  -0.18583655  0.19382644
   0.08072007 -0.23080587 -0.27483392  0.23421323]
 [-0.26697552  0.4480101   0.11724567 -0.12561119  0.02916038 -0.03143287
  -0.066679    0.29153156  0.39346075  0.37593222  0.45092857  0.12604153
   0.27737713 -0.14077675  0.33198702  0.18105698]
 [-0.49110103  0.19081533  0.3353871   0.0374155  -0.1608069  -0.49326098
   0.2697295  -0.07608783  0.45718455 -0.42017317 -0.463897    0.4719684
   0.01884913  0.20699263 -0.33571565  0.4935683 ]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:44:53,666 - __main__ - WARNING - Failed to train model for Green Energy
2025-04-06 15:44:53,666 - __main__ - INFO - Processing industry 13/34: Telecommunications
2025-04-06 15:44:53,667 - __main__ - INFO - Found 55 stocks in Telecommunications industry
2025-04-06 15:44:55,099 - __main__ - INFO - Saved 970 records for Telecommunications to industry_data_from_db\telecommunications_training.csv
2025-04-06 15:44:55,587 - __main__ - INFO - Training model for Telecommunications with 970 records
2025-04-06 15:44:55,587 - __main__ - INFO - Training model for Telecommunications with 970 records
2025-04-06 15:44:55,587 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:44:55,588 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:44:55,614 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:44:55,614 - __main__ - INFO - Training fold 1/5
2025-04-06 15:45:23,441 - __main__ - INFO - Training fold 2/5
2025-04-06 15:45:23,493 - __main__ - ERROR - Error training model for Telecommunications: Unknown variable: <Variable path=sequential_38/dense_114/kernel, shape=(8, 16), dtype=float32, value=[[ 0.29710495  0.3911339  -0.4654106   0.34562325 -0.2473247   0.42415082
  -0.25990796  0.08050418  0.42945826 -0.24293816 -0.27969396 -0.02960074
  -0.30511498  0.06288862 -0.29219115  0.24838626]
 [ 0.27208054 -0.3391074  -0.13625336 -0.25833857 -0.44605827  0.0374465
  -0.4519688  -0.4663366  -0.49593806 -0.03511214  0.3163005  -0.44156754
   0.40714014 -0.01283944  0.01389349 -0.226066  ]
 [ 0.3325547   0.3502549   0.34755754  0.27941525  0.18492043  0.3756336
   0.24444771 -0.42559016  0.06688595 -0.385136   -0.2148658   0.13906395
  -0.3818581  -0.20670724  0.25810945 -0.07084823]
 [ 0.16144836  0.00749207 -0.2845471  -0.3046142  -0.11344326 -0.24979162
   0.36706567 -0.07489932  0.48823178  0.34339166  0.25859094 -0.49463248
  -0.06559551  0.3548845  -0.42747664 -0.2897799 ]
 [ 0.05580461  0.41658938  0.2190665  -0.17907238 -0.05158246 -0.15561926
   0.46899962  0.28431654  0.3924216  -0.20303285  0.12450027 -0.4320817
  -0.05139017 -0.41222286  0.23792505  0.42832625]
 [-0.23079073  0.00747025  0.40028346  0.20101237  0.18861282 -0.06346202
  -0.23122132 -0.25652564 -0.11004651 -0.4308151   0.42544568 -0.27193975
  -0.03476954  0.02685487  0.06963909  0.09579277]
 [-0.3970679   0.26248944  0.10655451 -0.10098541  0.01693022 -0.18033946
  -0.34271967  0.20715666  0.2878605  -0.42900097  0.09700549 -0.41497815
  -0.2501788   0.32637298 -0.29025483 -0.01172137]
 [ 0.16396618  0.45481384 -0.39877558  0.08735204  0.15636563 -0.137187
  -0.09336901 -0.32036185 -0.33380115 -0.4852749  -0.20789659 -0.2142955
   0.41522014  0.09758568  0.06744039  0.12979758]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:45:23,494 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_38/dense_114/kernel, shape=(8, 16), dtype=float32, value=[[ 0.29710495  0.3911339  -0.4654106   0.34562325 -0.2473247   0.42415082
  -0.25990796  0.08050418  0.42945826 -0.24293816 -0.27969396 -0.02960074
  -0.30511498  0.06288862 -0.29219115  0.24838626]
 [ 0.27208054 -0.3391074  -0.13625336 -0.25833857 -0.44605827  0.0374465
  -0.4519688  -0.4663366  -0.49593806 -0.03511214  0.3163005  -0.44156754
   0.40714014 -0.01283944  0.01389349 -0.226066  ]
 [ 0.3325547   0.3502549   0.34755754  0.27941525  0.18492043  0.3756336
   0.24444771 -0.42559016  0.06688595 -0.385136   -0.2148658   0.13906395
  -0.3818581  -0.20670724  0.25810945 -0.07084823]
 [ 0.16144836  0.00749207 -0.2845471  -0.3046142  -0.11344326 -0.24979162
   0.36706567 -0.07489932  0.48823178  0.34339166  0.25859094 -0.49463248
  -0.06559551  0.3548845  -0.42747664 -0.2897799 ]
 [ 0.05580461  0.41658938  0.2190665  -0.17907238 -0.05158246 -0.15561926
   0.46899962  0.28431654  0.3924216  -0.20303285  0.12450027 -0.4320817
  -0.05139017 -0.41222286  0.23792505  0.42832625]
 [-0.23079073  0.00747025  0.40028346  0.20101237  0.18861282 -0.06346202
  -0.23122132 -0.25652564 -0.11004651 -0.4308151   0.42544568 -0.27193975
  -0.03476954  0.02685487  0.06963909  0.09579277]
 [-0.3970679   0.26248944  0.10655451 -0.10098541  0.01693022 -0.18033946
  -0.34271967  0.20715666  0.2878605  -0.42900097  0.09700549 -0.41497815
  -0.2501788   0.32637298 -0.29025483 -0.01172137]
 [ 0.16396618  0.45481384 -0.39877558  0.08735204  0.15636563 -0.137187
  -0.09336901 -0.32036185 -0.33380115 -0.4852749  -0.20789659 -0.2142955
   0.41522014  0.09758568  0.06744039  0.12979758]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:45:23,494 - __main__ - WARNING - Failed to train model for Telecommunications
2025-04-06 15:45:23,494 - __main__ - INFO - Processing industry 14/34: Steel & Metals
2025-04-06 15:45:23,495 - __main__ - INFO - Found 54 stocks in Steel & Metals industry
2025-04-06 15:45:25,789 - __main__ - INFO - Saved 930 records for Steel & Metals to industry_data_from_db\steel_&_metals_training.csv
2025-04-06 15:45:26,334 - __main__ - INFO - Training model for Steel & Metals with 930 records
2025-04-06 15:45:26,334 - __main__ - INFO - Training model for Steel & Metals with 930 records
2025-04-06 15:45:26,335 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:45:26,335 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:45:26,366 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:45:26,366 - __main__ - INFO - Training fold 1/5
2025-04-06 15:45:57,057 - __main__ - INFO - Training fold 2/5
2025-04-06 15:45:57,126 - __main__ - ERROR - Error training model for Steel & Metals: Unknown variable: <Variable path=sequential_41/dense_123/kernel, shape=(8, 16), dtype=float32, value=[[-2.73543596e-02  2.91904807e-01  1.05089664e-01  9.33823586e-02
   1.39909983e-01  3.22905064e-01  2.85279870e-01  4.68313932e-01
   2.22753048e-01  1.00589633e-01  1.00334883e-02  3.30390930e-01
  -1.70863867e-02 -8.62871408e-02 -2.07069039e-01 -6.31048679e-02]
 [-3.19628716e-01  5.51013947e-02 -8.57551098e-02  2.97546268e-01
  -4.27880526e-01 -1.80623531e-01 -2.19824314e-01 -1.72593355e-01
   2.17606902e-01 -2.93293238e-01  9.08744335e-02 -4.34908867e-01
   3.91091824e-01  4.84811544e-01  4.30773973e-01 -3.25491071e-01]
 [-3.54627132e-01  2.77408242e-01  4.22662139e-01 -3.80745053e-01
   4.68850136e-03  1.99798107e-01 -4.45686817e-01 -2.72426605e-01
   1.46038651e-01  1.69340730e-01 -4.57819819e-01 -2.45867133e-01
   2.45898247e-01  2.94519067e-01 -2.97396660e-01  1.79282904e-01]
 [-3.07668447e-01 -2.42654085e-02  4.02079105e-01  3.39177847e-02
  -8.04226398e-02 -7.86268711e-02  4.62887883e-01  3.73075366e-01
   3.14215779e-01  2.89654732e-03 -3.76929760e-01 -4.79029894e-01
  -1.67328715e-01  9.62121487e-02 -2.75474429e-01 -1.00916862e-01]
 [ 4.89346027e-01 -3.97820950e-01  2.02667832e-01 -3.28021646e-01
   1.73366427e-01 -2.44785428e-01  4.45529222e-02 -4.94535565e-01
  -2.76446700e-01 -1.44645572e-01  4.96127605e-01  7.78145790e-02
   4.08980489e-01 -4.13298607e-04  3.29497814e-01 -4.89734054e-01]
 [ 1.77954793e-01  4.54683661e-01 -1.65762305e-01  1.91091657e-01
   1.65767670e-01 -1.21690035e-01 -3.33024263e-01 -2.05824971e-01
   2.99589276e-01  2.00511694e-01 -4.05189395e-01 -1.31964445e-01
   4.37386751e-01 -1.80068016e-02  4.61155534e-01  2.82033205e-01]
 [-2.55529046e-01  2.45783567e-01 -4.07335162e-01 -1.82110190e-01
  -3.00691724e-01 -2.41816044e-01  2.78235793e-01 -3.69174957e-01
  -2.13326693e-01  4.71490502e-01  6.58648014e-02 -1.20545387e-01
   2.04061747e-01 -3.84351969e-01  4.10707235e-01 -3.49402428e-04]
 [ 4.89255786e-01  2.47131824e-01 -3.53610873e-01 -1.17362142e-01
   1.59271359e-01  8.24860334e-02  4.46140051e-01 -1.86774611e-01
   4.09098148e-01  4.12825823e-01  2.36124396e-01  4.17638659e-01
   6.53480291e-02 -5.34124374e-02  9.20100212e-02  8.39426517e-02]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:45:57,127 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_41/dense_123/kernel, shape=(8, 16), dtype=float32, value=[[-2.73543596e-02  2.91904807e-01  1.05089664e-01  9.33823586e-02
   1.39909983e-01  3.22905064e-01  2.85279870e-01  4.68313932e-01
   2.22753048e-01  1.00589633e-01  1.00334883e-02  3.30390930e-01
  -1.70863867e-02 -8.62871408e-02 -2.07069039e-01 -6.31048679e-02]
 [-3.19628716e-01  5.51013947e-02 -8.57551098e-02  2.97546268e-01
  -4.27880526e-01 -1.80623531e-01 -2.19824314e-01 -1.72593355e-01
   2.17606902e-01 -2.93293238e-01  9.08744335e-02 -4.34908867e-01
   3.91091824e-01  4.84811544e-01  4.30773973e-01 -3.25491071e-01]
 [-3.54627132e-01  2.77408242e-01  4.22662139e-01 -3.80745053e-01
   4.68850136e-03  1.99798107e-01 -4.45686817e-01 -2.72426605e-01
   1.46038651e-01  1.69340730e-01 -4.57819819e-01 -2.45867133e-01
   2.45898247e-01  2.94519067e-01 -2.97396660e-01  1.79282904e-01]
 [-3.07668447e-01 -2.42654085e-02  4.02079105e-01  3.39177847e-02
  -8.04226398e-02 -7.86268711e-02  4.62887883e-01  3.73075366e-01
   3.14215779e-01  2.89654732e-03 -3.76929760e-01 -4.79029894e-01
  -1.67328715e-01  9.62121487e-02 -2.75474429e-01 -1.00916862e-01]
 [ 4.89346027e-01 -3.97820950e-01  2.02667832e-01 -3.28021646e-01
   1.73366427e-01 -2.44785428e-01  4.45529222e-02 -4.94535565e-01
  -2.76446700e-01 -1.44645572e-01  4.96127605e-01  7.78145790e-02
   4.08980489e-01 -4.13298607e-04  3.29497814e-01 -4.89734054e-01]
 [ 1.77954793e-01  4.54683661e-01 -1.65762305e-01  1.91091657e-01
   1.65767670e-01 -1.21690035e-01 -3.33024263e-01 -2.05824971e-01
   2.99589276e-01  2.00511694e-01 -4.05189395e-01 -1.31964445e-01
   4.37386751e-01 -1.80068016e-02  4.61155534e-01  2.82033205e-01]
 [-2.55529046e-01  2.45783567e-01 -4.07335162e-01 -1.82110190e-01
  -3.00691724e-01 -2.41816044e-01  2.78235793e-01 -3.69174957e-01
  -2.13326693e-01  4.71490502e-01  6.58648014e-02 -1.20545387e-01
   2.04061747e-01 -3.84351969e-01  4.10707235e-01 -3.49402428e-04]
 [ 4.89255786e-01  2.47131824e-01 -3.53610873e-01 -1.17362142e-01
   1.59271359e-01  8.24860334e-02  4.46140051e-01 -1.86774611e-01
   4.09098148e-01  4.12825823e-01  2.36124396e-01  4.17638659e-01
   6.53480291e-02 -5.34124374e-02  9.20100212e-02  8.39426517e-02]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:45:57,127 - __main__ - WARNING - Failed to train model for Steel & Metals
2025-04-06 15:45:57,127 - __main__ - INFO - Processing industry 15/34: Electronics Distribution
2025-04-06 15:45:57,129 - __main__ - INFO - Found 48 stocks in Electronics Distribution industry
2025-04-06 15:45:58,804 - __main__ - INFO - Saved 719 records for Electronics Distribution to industry_data_from_db\electronics_distribution_training.csv
2025-04-06 15:45:59,256 - __main__ - INFO - Training model for Electronics Distribution with 719 records
2025-04-06 15:45:59,256 - __main__ - INFO - Training model for Electronics Distribution with 719 records
2025-04-06 15:45:59,256 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:45:59,257 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:45:59,282 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:45:59,282 - __main__ - INFO - Training fold 1/5
2025-04-06 15:46:13,498 - __main__ - INFO - Training fold 2/5
2025-04-06 15:46:13,551 - __main__ - ERROR - Error training model for Electronics Distribution: Unknown variable: <Variable path=sequential_44/dense_132/kernel, shape=(8, 16), dtype=float32, value=[[-0.3222934  -0.30999327  0.45123684  0.40426075  0.3102548   0.17876673
  -0.34744442  0.15431035 -0.00771677  0.05673957  0.26174402  0.09434104
  -0.4858681   0.47045875 -0.1083256  -0.2158196 ]
 [ 0.3158872  -0.09275067 -0.00249708 -0.14768744 -0.48279548 -0.38131678
   0.01194477 -0.20491946 -0.35979724 -0.01350188  0.41756737 -0.1431073
   0.3998127   0.2792337   0.3416053  -0.41973495]
 [ 0.36271     0.13648844 -0.44656956  0.15631866  0.47199142 -0.49597692
   0.00126064  0.35114098  0.1406442  -0.3215232   0.47737694 -0.21396339
   0.38924325  0.24803257  0.48980892 -0.3616153 ]
 [ 0.2566929  -0.14529812  0.46163952  0.19953406  0.18992627 -0.19337356
   0.09022427  0.16714823  0.33640826 -0.20299423 -0.10063314 -0.23253179
  -0.41753733  0.4563377   0.15316606 -0.4006002 ]
 [ 0.2058754   0.3334911  -0.41909373  0.22667706 -0.4197576  -0.0271703
   0.41318953 -0.20471227  0.35804832 -0.34911704 -0.46473682 -0.20559335
   0.07173049 -0.39453232  0.14441657  0.17995262]
 [ 0.13566566 -0.18791735 -0.49430788  0.39596403  0.4036306   0.05652082
  -0.43396056 -0.19945693 -0.43348932 -0.497424    0.09563148  0.42157495
   0.22422409 -0.47376692 -0.11831653 -0.11475945]
 [-0.24914181 -0.13478982 -0.33756983  0.21462822 -0.24670422 -0.01389086
   0.21594274 -0.32947206 -0.27616835  0.2917168  -0.03877234 -0.02263272
   0.27891576  0.38735676 -0.16354227 -0.02419615]
 [ 0.28539062  0.25680482  0.06926453  0.38291776  0.19165492  0.49167967
  -0.01405895 -0.0031147  -0.25865233 -0.44654298 -0.2685535  -0.04600811
   0.11546993 -0.19956207 -0.17599511 -0.1528151 ]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:46:13,551 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_44/dense_132/kernel, shape=(8, 16), dtype=float32, value=[[-0.3222934  -0.30999327  0.45123684  0.40426075  0.3102548   0.17876673
  -0.34744442  0.15431035 -0.00771677  0.05673957  0.26174402  0.09434104
  -0.4858681   0.47045875 -0.1083256  -0.2158196 ]
 [ 0.3158872  -0.09275067 -0.00249708 -0.14768744 -0.48279548 -0.38131678
   0.01194477 -0.20491946 -0.35979724 -0.01350188  0.41756737 -0.1431073
   0.3998127   0.2792337   0.3416053  -0.41973495]
 [ 0.36271     0.13648844 -0.44656956  0.15631866  0.47199142 -0.49597692
   0.00126064  0.35114098  0.1406442  -0.3215232   0.47737694 -0.21396339
   0.38924325  0.24803257  0.48980892 -0.3616153 ]
 [ 0.2566929  -0.14529812  0.46163952  0.19953406  0.18992627 -0.19337356
   0.09022427  0.16714823  0.33640826 -0.20299423 -0.10063314 -0.23253179
  -0.41753733  0.4563377   0.15316606 -0.4006002 ]
 [ 0.2058754   0.3334911  -0.41909373  0.22667706 -0.4197576  -0.0271703
   0.41318953 -0.20471227  0.35804832 -0.34911704 -0.46473682 -0.20559335
   0.07173049 -0.39453232  0.14441657  0.17995262]
 [ 0.13566566 -0.18791735 -0.49430788  0.39596403  0.4036306   0.05652082
  -0.43396056 -0.19945693 -0.43348932 -0.497424    0.09563148  0.42157495
   0.22422409 -0.47376692 -0.11831653 -0.11475945]
 [-0.24914181 -0.13478982 -0.33756983  0.21462822 -0.24670422 -0.01389086
   0.21594274 -0.32947206 -0.27616835  0.2917168  -0.03877234 -0.02263272
   0.27891576  0.38735676 -0.16354227 -0.02419615]
 [ 0.28539062  0.25680482  0.06926453  0.38291776  0.19165492  0.49167967
  -0.01405895 -0.0031147  -0.25865233 -0.44654298 -0.2685535  -0.04600811
   0.11546993 -0.19956207 -0.17599511 -0.1528151 ]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:46:13,552 - __main__ - WARNING - Failed to train model for Electronics Distribution
2025-04-06 15:46:13,552 - __main__ - INFO - Processing industry 16/34: Technology Services
2025-04-06 15:46:13,553 - __main__ - INFO - Found 46 stocks in Technology Services industry
2025-04-06 15:46:14,765 - __main__ - INFO - Saved 680 records for Technology Services to industry_data_from_db\technology_services_training.csv
2025-04-06 15:46:15,267 - __main__ - INFO - Training model for Technology Services with 680 records
2025-04-06 15:46:15,267 - __main__ - INFO - Training model for Technology Services with 680 records
2025-04-06 15:46:15,267 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:46:15,268 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:46:15,296 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:46:15,296 - __main__ - INFO - Training fold 1/5
2025-04-06 15:46:38,523 - __main__ - INFO - Training fold 2/5
2025-04-06 15:46:38,572 - __main__ - ERROR - Error training model for Technology Services: Unknown variable: <Variable path=sequential_47/dense_141/kernel, shape=(8, 16), dtype=float32, value=[[ 0.29585135  0.07527065 -0.17827046  0.26981413 -0.23912632 -0.02774882
   0.3634888   0.05250549  0.17319548 -0.3932109  -0.21232975  0.27499652
   0.33105373 -0.14649153 -0.39305496  0.23330534]
 [-0.3170756   0.46818566  0.00059211  0.111256    0.23233116 -0.28998697
  -0.16569293  0.1951381  -0.02345967  0.01952469 -0.34440553 -0.06358016
  -0.31312633 -0.09616959 -0.3520124  -0.14324379]
 [ 0.21644032 -0.27259135 -0.4978273  -0.40394855  0.44234526 -0.13123584
   0.11706555 -0.32973874  0.3571663  -0.02953959  0.2615757   0.31376302
   0.44289935 -0.11324942  0.20635712 -0.2060039 ]
 [ 0.430498    0.0436126  -0.32654274  0.34732473  0.27534044 -0.06377447
   0.25876236 -0.0721643  -0.2753482  -0.3997476  -0.21572208 -0.01882994
   0.29093802 -0.28286862 -0.4397111   0.2234745 ]
 [ 0.49618232 -0.3775822   0.1553595  -0.05523121 -0.47746265  0.10492051
  -0.35133898  0.47652793 -0.05271637  0.42211568 -0.24383879 -0.15840077
  -0.21662676 -0.45579934  0.17801559 -0.26706302]
 [-0.41668594 -0.27700806 -0.21578562  0.07790554 -0.27040184 -0.00684905
   0.08379805 -0.04501724 -0.25306153  0.2943567  -0.24145544 -0.02448833
  -0.07464755 -0.35670042 -0.06208646  0.16432238]
 [-0.23338425  0.48544145 -0.18161285  0.17292953  0.49740934 -0.18719864
   0.2824713  -0.2890054   0.12618339  0.27987468 -0.48083687  0.41384566
  -0.37174904  0.27736747 -0.17745984  0.49867082]
 [ 0.29839492 -0.02318156 -0.16674328 -0.28630698 -0.3406682  -0.2455405
  -0.46869338 -0.26302326 -0.33046138  0.23820913 -0.27326798 -0.00405359
   0.13170826 -0.24777699  0.01621008 -0.16304898]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:46:38,573 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_47/dense_141/kernel, shape=(8, 16), dtype=float32, value=[[ 0.29585135  0.07527065 -0.17827046  0.26981413 -0.23912632 -0.02774882
   0.3634888   0.05250549  0.17319548 -0.3932109  -0.21232975  0.27499652
   0.33105373 -0.14649153 -0.39305496  0.23330534]
 [-0.3170756   0.46818566  0.00059211  0.111256    0.23233116 -0.28998697
  -0.16569293  0.1951381  -0.02345967  0.01952469 -0.34440553 -0.06358016
  -0.31312633 -0.09616959 -0.3520124  -0.14324379]
 [ 0.21644032 -0.27259135 -0.4978273  -0.40394855  0.44234526 -0.13123584
   0.11706555 -0.32973874  0.3571663  -0.02953959  0.2615757   0.31376302
   0.44289935 -0.11324942  0.20635712 -0.2060039 ]
 [ 0.430498    0.0436126  -0.32654274  0.34732473  0.27534044 -0.06377447
   0.25876236 -0.0721643  -0.2753482  -0.3997476  -0.21572208 -0.01882994
   0.29093802 -0.28286862 -0.4397111   0.2234745 ]
 [ 0.49618232 -0.3775822   0.1553595  -0.05523121 -0.47746265  0.10492051
  -0.35133898  0.47652793 -0.05271637  0.42211568 -0.24383879 -0.15840077
  -0.21662676 -0.45579934  0.17801559 -0.26706302]
 [-0.41668594 -0.27700806 -0.21578562  0.07790554 -0.27040184 -0.00684905
   0.08379805 -0.04501724 -0.25306153  0.2943567  -0.24145544 -0.02448833
  -0.07464755 -0.35670042 -0.06208646  0.16432238]
 [-0.23338425  0.48544145 -0.18161285  0.17292953  0.49740934 -0.18719864
   0.2824713  -0.2890054   0.12618339  0.27987468 -0.48083687  0.41384566
  -0.37174904  0.27736747 -0.17745984  0.49867082]
 [ 0.29839492 -0.02318156 -0.16674328 -0.28630698 -0.3406682  -0.2455405
  -0.46869338 -0.26302326 -0.33046138  0.23820913 -0.27326798 -0.00405359
   0.13170826 -0.24777699  0.01621008 -0.16304898]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:46:38,573 - __main__ - WARNING - Failed to train model for Technology Services
2025-04-06 15:46:38,573 - __main__ - INFO - Processing industry 17/34: Food & Beverage
2025-04-06 15:46:38,575 - __main__ - INFO - Found 42 stocks in Food & Beverage industry
2025-04-06 15:46:39,613 - __main__ - INFO - Saved 616 records for Food & Beverage to industry_data_from_db\food_&_beverage_training.csv
2025-04-06 15:46:41,217 - __main__ - INFO - Training model for Food & Beverage with 616 records
2025-04-06 15:46:41,217 - __main__ - INFO - Training model for Food & Beverage with 616 records
2025-04-06 15:46:41,218 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:46:41,218 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:46:41,244 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:46:41,244 - __main__ - INFO - Training fold 1/5
2025-04-06 15:47:01,020 - __main__ - INFO - Training fold 2/5
2025-04-06 15:47:01,075 - __main__ - ERROR - Error training model for Food & Beverage: Unknown variable: <Variable path=sequential_50/dense_150/kernel, shape=(8, 16), dtype=float32, value=[[ 0.40122354 -0.46599352 -0.19611633  0.19191182 -0.29727995 -0.05393374
  -0.22350383  0.12790489  0.18505538  0.12937379  0.39230764 -0.32200086
   0.15653825  0.2746266  -0.30982327  0.3000747 ]
 [-0.17979217 -0.2786653   0.40113878 -0.37163353 -0.25262105 -0.13038075
   0.05334723 -0.23230565 -0.23051083 -0.36552572  0.11159742  0.46883512
  -0.3046677  -0.24786854  0.16237342 -0.34608984]
 [-0.44045794  0.06393921  0.22320032  0.2355504  -0.12043178  0.27687776
  -0.22249115 -0.23109174 -0.05827892  0.18679845 -0.3826102  -0.25221503
  -0.4885316  -0.12567925 -0.18469179  0.33970714]
 [-0.30768132 -0.35709405 -0.495095   -0.48172975 -0.38363636 -0.3192538
  -0.35094583 -0.17364693  0.02795041 -0.21856618 -0.1971513  -0.27774525
  -0.13872671  0.3446406  -0.07846999 -0.19347858]
 [ 0.36451757 -0.28507972 -0.13223433  0.11194098 -0.30678797 -0.17268789
   0.42666328 -0.16752613 -0.12119293  0.1557653  -0.0306381  -0.36993325
   0.25623906  0.05128825 -0.08806527 -0.17808032]
 [ 0.4322374  -0.08643973  0.0400244  -0.45257556  0.1273948  -0.05910158
  -0.20211005  0.10881162 -0.31413913 -0.38064218 -0.31844747 -0.0168519
   0.01917207 -0.19896054  0.34440625 -0.2679149 ]
 [-0.2650782  -0.47215533 -0.01901853  0.13267887 -0.0565753  -0.35231602
  -0.23066497 -0.3468715   0.32898068 -0.22425926  0.20641029 -0.2919259
   0.0270679   0.31891108  0.26401508  0.37251985]
 [-0.25560033 -0.22240233  0.10528398  0.36054575  0.33768559  0.13271928
  -0.47675717  0.12254548 -0.22650945 -0.0672394  -0.45519435 -0.10895562
   0.1997875   0.23623121 -0.03784549  0.46381652]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:47:01,076 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_50/dense_150/kernel, shape=(8, 16), dtype=float32, value=[[ 0.40122354 -0.46599352 -0.19611633  0.19191182 -0.29727995 -0.05393374
  -0.22350383  0.12790489  0.18505538  0.12937379  0.39230764 -0.32200086
   0.15653825  0.2746266  -0.30982327  0.3000747 ]
 [-0.17979217 -0.2786653   0.40113878 -0.37163353 -0.25262105 -0.13038075
   0.05334723 -0.23230565 -0.23051083 -0.36552572  0.11159742  0.46883512
  -0.3046677  -0.24786854  0.16237342 -0.34608984]
 [-0.44045794  0.06393921  0.22320032  0.2355504  -0.12043178  0.27687776
  -0.22249115 -0.23109174 -0.05827892  0.18679845 -0.3826102  -0.25221503
  -0.4885316  -0.12567925 -0.18469179  0.33970714]
 [-0.30768132 -0.35709405 -0.495095   -0.48172975 -0.38363636 -0.3192538
  -0.35094583 -0.17364693  0.02795041 -0.21856618 -0.1971513  -0.27774525
  -0.13872671  0.3446406  -0.07846999 -0.19347858]
 [ 0.36451757 -0.28507972 -0.13223433  0.11194098 -0.30678797 -0.17268789
   0.42666328 -0.16752613 -0.12119293  0.1557653  -0.0306381  -0.36993325
   0.25623906  0.05128825 -0.08806527 -0.17808032]
 [ 0.4322374  -0.08643973  0.0400244  -0.45257556  0.1273948  -0.05910158
  -0.20211005  0.10881162 -0.31413913 -0.38064218 -0.31844747 -0.0168519
   0.01917207 -0.19896054  0.34440625 -0.2679149 ]
 [-0.2650782  -0.47215533 -0.01901853  0.13267887 -0.0565753  -0.35231602
  -0.23066497 -0.3468715   0.32898068 -0.22425926  0.20641029 -0.2919259
   0.0270679   0.31891108  0.26401508  0.37251985]
 [-0.25560033 -0.22240233  0.10528398  0.36054575  0.33768559  0.13271928
  -0.47675717  0.12254548 -0.22650945 -0.0672394  -0.45519435 -0.10895562
   0.1997875   0.23623121 -0.03784549  0.46381652]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:47:01,077 - __main__ - WARNING - Failed to train model for Food & Beverage
2025-04-06 15:47:01,077 - __main__ - INFO - Processing industry 18/34: Automotive
2025-04-06 15:47:01,078 - __main__ - INFO - Found 39 stocks in Automotive industry
2025-04-06 15:47:02,097 - __main__ - INFO - Saved 641 records for Automotive to industry_data_from_db\automotive_training.csv
2025-04-06 15:47:02,627 - __main__ - INFO - Training model for Automotive with 641 records
2025-04-06 15:47:02,627 - __main__ - INFO - Training model for Automotive with 641 records
2025-04-06 15:47:02,627 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:47:02,628 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:47:02,654 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:47:02,656 - __main__ - INFO - Training fold 1/5
2025-04-06 15:47:12,174 - __main__ - INFO - Training fold 2/5
2025-04-06 15:47:12,224 - __main__ - ERROR - Error training model for Automotive: Unknown variable: <Variable path=sequential_53/dense_159/kernel, shape=(8, 16), dtype=float32, value=[[ 0.41392875  0.14353395 -0.29471743  0.22165418  0.48980165 -0.08635306
  -0.07404518  0.15526319 -0.0203414  -0.49284565 -0.05539441 -0.29437077
   0.11092997  0.30359352  0.14332986  0.43286157]
 [ 0.46610475  0.35900104 -0.16333282  0.22965145  0.26402545 -0.02985108
  -0.23159015  0.02931976  0.1270324  -0.0537771  -0.35144532 -0.266302
   0.4040326   0.43003094 -0.18329406 -0.31340063]
 [-0.02440655 -0.40444624  0.37433386 -0.26363087  0.0589633   0.09489679
  -0.18089163 -0.10835087  0.40173662  0.06821072  0.10814714 -0.31558847
   0.4058454  -0.42599308 -0.25575066 -0.03192949]
 [ 0.05310178 -0.2669108  -0.1698854   0.06821895 -0.08968878 -0.08242512
   0.16639245 -0.17605627  0.26049185 -0.47576296  0.04254985 -0.14789248
  -0.48398614 -0.27504194 -0.26106107  0.20415163]
 [ 0.2641877   0.17359364  0.02446926  0.49257123 -0.218364    0.3335216
   0.45323086 -0.20317674  0.46285605  0.01547754 -0.3588351   0.20722055
  -0.0241847   0.1241082  -0.46586108  0.22457671]
 [-0.00670385  0.49031246  0.4988407   0.02403855  0.22421598 -0.10498655
   0.44633365  0.21541429  0.04126358  0.31520867  0.43764234 -0.14672399
   0.13261223  0.3738351   0.01120985  0.31251276]
 [-0.43187642  0.02082551 -0.10316324 -0.17594647  0.10856187  0.04590547
   0.34045398  0.07295644 -0.47350085 -0.21183336 -0.43073773  0.314865
   0.3593155  -0.4110899   0.13070011 -0.24076307]
 [ 0.26434696  0.46152544 -0.24919069 -0.11571145 -0.48468268 -0.40329826
   0.04916036  0.20427346  0.22875082  0.4181353  -0.43287325 -0.33163393
  -0.25139046 -0.3638214   0.047261   -0.35130644]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:47:12,226 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_53/dense_159/kernel, shape=(8, 16), dtype=float32, value=[[ 0.41392875  0.14353395 -0.29471743  0.22165418  0.48980165 -0.08635306
  -0.07404518  0.15526319 -0.0203414  -0.49284565 -0.05539441 -0.29437077
   0.11092997  0.30359352  0.14332986  0.43286157]
 [ 0.46610475  0.35900104 -0.16333282  0.22965145  0.26402545 -0.02985108
  -0.23159015  0.02931976  0.1270324  -0.0537771  -0.35144532 -0.266302
   0.4040326   0.43003094 -0.18329406 -0.31340063]
 [-0.02440655 -0.40444624  0.37433386 -0.26363087  0.0589633   0.09489679
  -0.18089163 -0.10835087  0.40173662  0.06821072  0.10814714 -0.31558847
   0.4058454  -0.42599308 -0.25575066 -0.03192949]
 [ 0.05310178 -0.2669108  -0.1698854   0.06821895 -0.08968878 -0.08242512
   0.16639245 -0.17605627  0.26049185 -0.47576296  0.04254985 -0.14789248
  -0.48398614 -0.27504194 -0.26106107  0.20415163]
 [ 0.2641877   0.17359364  0.02446926  0.49257123 -0.218364    0.3335216
   0.45323086 -0.20317674  0.46285605  0.01547754 -0.3588351   0.20722055
  -0.0241847   0.1241082  -0.46586108  0.22457671]
 [-0.00670385  0.49031246  0.4988407   0.02403855  0.22421598 -0.10498655
   0.44633365  0.21541429  0.04126358  0.31520867  0.43764234 -0.14672399
   0.13261223  0.3738351   0.01120985  0.31251276]
 [-0.43187642  0.02082551 -0.10316324 -0.17594647  0.10856187  0.04590547
   0.34045398  0.07295644 -0.47350085 -0.21183336 -0.43073773  0.314865
   0.3593155  -0.4110899   0.13070011 -0.24076307]
 [ 0.26434696  0.46152544 -0.24919069 -0.11571145 -0.48468268 -0.40329826
   0.04916036  0.20427346  0.22875082  0.4181353  -0.43287325 -0.33163393
  -0.25139046 -0.3638214   0.047261   -0.35130644]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:47:12,226 - __main__ - WARNING - Failed to train model for Automotive
2025-04-06 15:47:12,226 - __main__ - INFO - Processing industry 19/34: Retail
2025-04-06 15:47:12,227 - __main__ - INFO - Found 37 stocks in Retail industry
2025-04-06 15:47:13,229 - __main__ - INFO - Saved 652 records for Retail to industry_data_from_db\retail_training.csv
2025-04-06 15:47:13,699 - __main__ - INFO - Training model for Retail with 652 records
2025-04-06 15:47:13,699 - __main__ - INFO - Training model for Retail with 652 records
2025-04-06 15:47:13,700 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:47:13,700 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:47:13,727 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:47:13,727 - __main__ - INFO - Training fold 1/5
2025-04-06 15:47:36,191 - __main__ - INFO - Training fold 2/5
2025-04-06 15:47:36,248 - __main__ - ERROR - Error training model for Retail: Unknown variable: <Variable path=sequential_56/dense_168/kernel, shape=(8, 16), dtype=float32, value=[[ 0.05469608 -0.21321976  0.23687577 -0.35157406  0.04828382  0.25383866
  -0.32696867 -0.22009516  0.18927705  0.1058861   0.35109222 -0.10005486
  -0.00725985  0.3892131  -0.48766732 -0.4181074 ]
 [ 0.4115932   0.00575149  0.12937152  0.45364726 -0.11306751  0.01482499
   0.17937744  0.24140191 -0.3658384  -0.06404626 -0.18618798  0.32105744
   0.46833718  0.09089148 -0.29421628  0.09891701]
 [ 0.29320574  0.4040643   0.09914672 -0.32844996  0.43895757  0.384982
  -0.19299674 -0.14064181 -0.30832374 -0.4863391  -0.14449048  0.36268258
   0.30528045  0.06566775  0.09958279  0.36363113]
 [ 0.39251506 -0.10905337  0.3384663  -0.21067548  0.2677318  -0.03458488
  -0.44452167  0.15762699  0.45942712  0.4438578  -0.40922904 -0.38341308
   0.32007313  0.25327337  0.15271342  0.29535818]
 [-0.44904613  0.35665143 -0.2571721  -0.27773368 -0.2756393  -0.30499244
   0.06366765 -0.19100118 -0.0867033   0.03066874  0.07782245  0.21956575
  -0.21727467 -0.28503346 -0.37608957 -0.34861124]
 [-0.48290086 -0.08445704  0.07320058 -0.11949027 -0.11732256  0.1971879
  -0.49610865 -0.44512153 -0.3962295  -0.35277593  0.16748989 -0.32718503
   0.36061466  0.0310297   0.28334427 -0.4586717 ]
 [-0.14584541 -0.09834146 -0.3360424   0.36738205 -0.42315924 -0.48295772
  -0.4039849  -0.15460777 -0.22233987  0.23120177 -0.06375384 -0.15528691
   0.34712303 -0.24450803  0.2949903   0.25859952]
 [-0.49025905 -0.4996202   0.42001462 -0.47203827 -0.22272408  0.3978498
   0.34659767 -0.00837433  0.41648924  0.22281873  0.319811    0.11752141
  -0.48216057  0.18379915  0.22667634  0.10727262]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:47:36,249 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_56/dense_168/kernel, shape=(8, 16), dtype=float32, value=[[ 0.05469608 -0.21321976  0.23687577 -0.35157406  0.04828382  0.25383866
  -0.32696867 -0.22009516  0.18927705  0.1058861   0.35109222 -0.10005486
  -0.00725985  0.3892131  -0.48766732 -0.4181074 ]
 [ 0.4115932   0.00575149  0.12937152  0.45364726 -0.11306751  0.01482499
   0.17937744  0.24140191 -0.3658384  -0.06404626 -0.18618798  0.32105744
   0.46833718  0.09089148 -0.29421628  0.09891701]
 [ 0.29320574  0.4040643   0.09914672 -0.32844996  0.43895757  0.384982
  -0.19299674 -0.14064181 -0.30832374 -0.4863391  -0.14449048  0.36268258
   0.30528045  0.06566775  0.09958279  0.36363113]
 [ 0.39251506 -0.10905337  0.3384663  -0.21067548  0.2677318  -0.03458488
  -0.44452167  0.15762699  0.45942712  0.4438578  -0.40922904 -0.38341308
   0.32007313  0.25327337  0.15271342  0.29535818]
 [-0.44904613  0.35665143 -0.2571721  -0.27773368 -0.2756393  -0.30499244
   0.06366765 -0.19100118 -0.0867033   0.03066874  0.07782245  0.21956575
  -0.21727467 -0.28503346 -0.37608957 -0.34861124]
 [-0.48290086 -0.08445704  0.07320058 -0.11949027 -0.11732256  0.1971879
  -0.49610865 -0.44512153 -0.3962295  -0.35277593  0.16748989 -0.32718503
   0.36061466  0.0310297   0.28334427 -0.4586717 ]
 [-0.14584541 -0.09834146 -0.3360424   0.36738205 -0.42315924 -0.48295772
  -0.4039849  -0.15460777 -0.22233987  0.23120177 -0.06375384 -0.15528691
   0.34712303 -0.24450803  0.2949903   0.25859952]
 [-0.49025905 -0.4996202   0.42001462 -0.47203827 -0.22272408  0.3978498
   0.34659767 -0.00837433  0.41648924  0.22281873  0.319811    0.11752141
  -0.48216057  0.18379915  0.22667634  0.10727262]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:47:36,249 - __main__ - WARNING - Failed to train model for Retail
2025-04-06 15:47:36,249 - __main__ - INFO - Processing industry 20/34: Media & Entertainment
2025-04-06 15:47:36,250 - __main__ - INFO - Found 37 stocks in Media & Entertainment industry
2025-04-06 15:47:37,381 - __main__ - INFO - Saved 582 records for Media & Entertainment to industry_data_from_db\media_&_entertainment_training.csv
2025-04-06 15:47:38,883 - __main__ - INFO - Training model for Media & Entertainment with 582 records
2025-04-06 15:47:38,883 - __main__ - INFO - Training model for Media & Entertainment with 582 records
2025-04-06 15:47:38,883 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:47:38,884 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:47:38,910 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:47:38,910 - __main__ - INFO - Training fold 1/5
2025-04-06 15:47:50,700 - __main__ - INFO - Training fold 2/5
2025-04-06 15:47:50,751 - __main__ - ERROR - Error training model for Media & Entertainment: Unknown variable: <Variable path=sequential_59/dense_177/kernel, shape=(8, 16), dtype=float32, value=[[ 0.27216017  0.38514102 -0.2412219  -0.1558088  -0.00297189 -0.2400477
   0.10495687 -0.19344914  0.02898622  0.25715995 -0.37059033 -0.08346415
   0.24832153  0.12433946 -0.35632575  0.3103633 ]
 [ 0.4489367   0.32846928  0.44931233  0.35598314  0.2440083   0.485178
  -0.48785102  0.3739829   0.20855379 -0.0147748   0.3445077   0.03220761
   0.43599033  0.10984814  0.11073411 -0.06649089]
 [-0.18188179  0.12402463  0.4994582   0.20674574  0.40913904 -0.10210621
   0.11096215 -0.10053492  0.49798417 -0.33845496  0.29140592 -0.39388978
  -0.3731761  -0.1886859   0.0213778  -0.13807285]
 [ 0.2541846  -0.17267644 -0.16945314 -0.28190422  0.26972902 -0.18841922
  -0.1439197   0.42124605  0.22247767  0.18470585 -0.21425653 -0.38775134
   0.20758271  0.07577777  0.21503139  0.02686691]
 [ 0.16100752 -0.37554884 -0.11696088  0.4188534   0.43809402  0.06680703
   0.45696783  0.3821075   0.21064997  0.08172548  0.35660303 -0.20780563
  -0.3518684  -0.24659419 -0.36721122  0.03510344]
 [ 0.19226635  0.01224399  0.45022178  0.14481914 -0.10193098  0.3004744
   0.20613849 -0.01255751 -0.10208619  0.23495293  0.27157128  0.35907257
   0.11309028 -0.27767694  0.32461274  0.17868829]
 [ 0.38630605 -0.08073592 -0.07631564 -0.39236736  0.18009055  0.20302975
   0.3941884   0.05212545  0.43628907 -0.07002366 -0.12496269  0.25243938
  -0.00296307 -0.24041796  0.19640493  0.16871142]
 [-0.25401115 -0.15927672 -0.46985435  0.436257    0.2809589   0.2028656
   0.08544552  0.25876963 -0.24333966 -0.10851777 -0.0701834   0.3209133
   0.12353909  0.1159035  -0.12409604 -0.38384604]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:47:50,752 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_59/dense_177/kernel, shape=(8, 16), dtype=float32, value=[[ 0.27216017  0.38514102 -0.2412219  -0.1558088  -0.00297189 -0.2400477
   0.10495687 -0.19344914  0.02898622  0.25715995 -0.37059033 -0.08346415
   0.24832153  0.12433946 -0.35632575  0.3103633 ]
 [ 0.4489367   0.32846928  0.44931233  0.35598314  0.2440083   0.485178
  -0.48785102  0.3739829   0.20855379 -0.0147748   0.3445077   0.03220761
   0.43599033  0.10984814  0.11073411 -0.06649089]
 [-0.18188179  0.12402463  0.4994582   0.20674574  0.40913904 -0.10210621
   0.11096215 -0.10053492  0.49798417 -0.33845496  0.29140592 -0.39388978
  -0.3731761  -0.1886859   0.0213778  -0.13807285]
 [ 0.2541846  -0.17267644 -0.16945314 -0.28190422  0.26972902 -0.18841922
  -0.1439197   0.42124605  0.22247767  0.18470585 -0.21425653 -0.38775134
   0.20758271  0.07577777  0.21503139  0.02686691]
 [ 0.16100752 -0.37554884 -0.11696088  0.4188534   0.43809402  0.06680703
   0.45696783  0.3821075   0.21064997  0.08172548  0.35660303 -0.20780563
  -0.3518684  -0.24659419 -0.36721122  0.03510344]
 [ 0.19226635  0.01224399  0.45022178  0.14481914 -0.10193098  0.3004744
   0.20613849 -0.01255751 -0.10208619  0.23495293  0.27157128  0.35907257
   0.11309028 -0.27767694  0.32461274  0.17868829]
 [ 0.38630605 -0.08073592 -0.07631564 -0.39236736  0.18009055  0.20302975
   0.3941884   0.05212545  0.43628907 -0.07002366 -0.12496269  0.25243938
  -0.00296307 -0.24041796  0.19640493  0.16871142]
 [-0.25401115 -0.15927672 -0.46985435  0.436257    0.2809589   0.2028656
   0.08544552  0.25876963 -0.24333966 -0.10851777 -0.0701834   0.3209133
   0.12353909  0.1159035  -0.12409604 -0.38384604]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:47:50,752 - __main__ - WARNING - Failed to train model for Media & Entertainment
2025-04-06 15:47:50,752 - __main__ - INFO - Processing industry 21/34: Shipping & Transportation
2025-04-06 15:47:50,753 - __main__ - INFO - Found 36 stocks in Shipping & Transportation industry
2025-04-06 15:47:51,924 - __main__ - INFO - Saved 614 records for Shipping & Transportation to industry_data_from_db\shipping_&_transportation_training.csv
2025-04-06 15:47:52,401 - __main__ - INFO - Training model for Shipping & Transportation with 614 records
2025-04-06 15:47:52,401 - __main__ - INFO - Training model for Shipping & Transportation with 614 records
2025-04-06 15:47:52,401 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:47:52,402 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:47:52,427 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:47:52,427 - __main__ - INFO - Training fold 1/5
2025-04-06 15:48:15,881 - __main__ - INFO - Training fold 2/5
2025-04-06 15:48:15,933 - __main__ - ERROR - Error training model for Shipping & Transportation: Unknown variable: <Variable path=sequential_62/dense_186/kernel, shape=(8, 16), dtype=float32, value=[[-0.05826712  0.18896961 -0.16775692 -0.03219306 -0.47143722 -0.3917173
   0.3361205  -0.0743562   0.28524435 -0.38187003 -0.1489718   0.45728385
  -0.0625869  -0.4445083   0.4912039   0.3638072 ]
 [-0.20124376 -0.15007126  0.04544675 -0.12181711  0.06301224  0.1465801
  -0.2338953   0.2577753  -0.06335008  0.23848557  0.15103996  0.07628417
  -0.4062984   0.11564457  0.36493015  0.20590746]
 [-0.34762394 -0.43517506 -0.27295613 -0.4261098  -0.01932073 -0.49146926
   0.09059894  0.07807171 -0.08330595 -0.12292528 -0.44104636 -0.18623424
  -0.3926971   0.26919806  0.07521415  0.04825282]
 [-0.0860498   0.19137418  0.03018987 -0.03011227 -0.16604972  0.4830438
  -0.2902342   0.23528469  0.38350046 -0.18493545  0.3468672  -0.18692195
   0.4727304   0.31363165 -0.23809874 -0.16054511]
 [ 0.46642125  0.05466592  0.3592124  -0.36072147 -0.2596135   0.27761924
   0.09416103  0.19457448  0.49649584 -0.34372544 -0.4593264  -0.392874
   0.10644901  0.24936962  0.41809475  0.45802176]
 [ 0.4025731  -0.10049772  0.40732348  0.25235772 -0.0468483   0.13760746
   0.4075669  -0.4520818   0.19380534  0.48541307  0.08747041  0.01811075
   0.01895833  0.42363226 -0.33830118  0.21013498]
 [-0.27916753 -0.04385185  0.08527303 -0.2664709   0.06272876  0.09650278
  -0.2474879   0.3496796   0.09362543  0.3978939  -0.09531057  0.44426358
  -0.00363362 -0.4015329   0.14147723 -0.16082168]
 [-0.01068962  0.22393227 -0.47005403  0.11774957  0.255538   -0.38655674
   0.4629712  -0.46810782 -0.12283409 -0.33209145  0.1976099   0.16298711
   0.4199766  -0.02407944 -0.07153964 -0.03149104]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:48:15,933 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_62/dense_186/kernel, shape=(8, 16), dtype=float32, value=[[-0.05826712  0.18896961 -0.16775692 -0.03219306 -0.47143722 -0.3917173
   0.3361205  -0.0743562   0.28524435 -0.38187003 -0.1489718   0.45728385
  -0.0625869  -0.4445083   0.4912039   0.3638072 ]
 [-0.20124376 -0.15007126  0.04544675 -0.12181711  0.06301224  0.1465801
  -0.2338953   0.2577753  -0.06335008  0.23848557  0.15103996  0.07628417
  -0.4062984   0.11564457  0.36493015  0.20590746]
 [-0.34762394 -0.43517506 -0.27295613 -0.4261098  -0.01932073 -0.49146926
   0.09059894  0.07807171 -0.08330595 -0.12292528 -0.44104636 -0.18623424
  -0.3926971   0.26919806  0.07521415  0.04825282]
 [-0.0860498   0.19137418  0.03018987 -0.03011227 -0.16604972  0.4830438
  -0.2902342   0.23528469  0.38350046 -0.18493545  0.3468672  -0.18692195
   0.4727304   0.31363165 -0.23809874 -0.16054511]
 [ 0.46642125  0.05466592  0.3592124  -0.36072147 -0.2596135   0.27761924
   0.09416103  0.19457448  0.49649584 -0.34372544 -0.4593264  -0.392874
   0.10644901  0.24936962  0.41809475  0.45802176]
 [ 0.4025731  -0.10049772  0.40732348  0.25235772 -0.0468483   0.13760746
   0.4075669  -0.4520818   0.19380534  0.48541307  0.08747041  0.01811075
   0.01895833  0.42363226 -0.33830118  0.21013498]
 [-0.27916753 -0.04385185  0.08527303 -0.2664709   0.06272876  0.09650278
  -0.2474879   0.3496796   0.09362543  0.3978939  -0.09531057  0.44426358
  -0.00363362 -0.4015329   0.14147723 -0.16082168]
 [-0.01068962  0.22393227 -0.47005403  0.11774957  0.255538   -0.38655674
   0.4629712  -0.46810782 -0.12283409 -0.33209145  0.1976099   0.16298711
   0.4199766  -0.02407944 -0.07153964 -0.03149104]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:48:15,934 - __main__ - WARNING - Failed to train model for Shipping & Transportation
2025-04-06 15:48:15,934 - __main__ - INFO - Processing industry 22/34: Sports & Leisure
2025-04-06 15:48:15,935 - __main__ - INFO - Found 30 stocks in Sports & Leisure industry
2025-04-06 15:48:16,698 - __main__ - INFO - Saved 462 records for Sports & Leisure to industry_data_from_db\sports_&_leisure_training.csv
2025-04-06 15:48:17,521 - __main__ - INFO - Training model for Sports & Leisure with 462 records
2025-04-06 15:48:17,521 - __main__ - INFO - Training model for Sports & Leisure with 462 records
2025-04-06 15:48:17,521 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:48:17,522 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:48:17,548 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:48:17,549 - __main__ - INFO - Training fold 1/5
2025-04-06 15:48:36,523 - __main__ - INFO - Training fold 2/5
2025-04-06 15:48:36,586 - __main__ - ERROR - Error training model for Sports & Leisure: Unknown variable: <Variable path=sequential_65/dense_195/kernel, shape=(8, 16), dtype=float32, value=[[ 0.35936034 -0.35557628 -0.34425426  0.15627193  0.25395036  0.4861418
  -0.3777609   0.29977584  0.263376   -0.44185686 -0.02886856  0.18214524
   0.2728765   0.15910864  0.333426    0.4531144 ]
 [ 0.23644423  0.03811896  0.23325431  0.29200447 -0.43566537 -0.4820249
   0.48147917  0.28891957  0.2752409  -0.01170421 -0.35521352  0.10564983
   0.14779401  0.1335845  -0.3005401   0.278677  ]
 [-0.14328086  0.09070969 -0.15907383 -0.47367883  0.38999307  0.44525564
   0.12562227  0.11941528  0.2960074  -0.41728163 -0.15004778 -0.49305785
  -0.1606462  -0.04236662 -0.45392382  0.06183386]
 [ 0.08300531  0.1608752   0.46820426  0.1922183   0.4089781  -0.41120744
  -0.3029548  -0.27739656  0.4888562  -0.03937018  0.22600865 -0.22843027
  -0.14404893  0.4097607   0.11375034 -0.48008037]
 [-0.28013992  0.2736659   0.33548033 -0.16986847  0.07537436  0.22653484
   0.32657695 -0.17741191 -0.4470024  -0.21934032  0.2977295   0.35579848
  -0.23269808  0.40518188  0.14422464 -0.22517323]
 [ 0.12787437 -0.34965754 -0.07784939  0.4136969   0.4838555   0.12634194
   0.38625705 -0.17591667 -0.48070538  0.27606165  0.392187   -0.49717736
   0.45301342 -0.32596838 -0.35185432  0.27336752]
 [-0.4498173   0.49290645  0.30127144 -0.3849275   0.0012219   0.20855772
   0.14327168  0.3420092   0.08186126 -0.06936908  0.24397182  0.23134899
  -0.23327053  0.44918573  0.18220544  0.00287271]
 [ 0.12959802 -0.10658205  0.12562215 -0.07332659 -0.04671144  0.17803776
   0.04826331 -0.21147501  0.34219158 -0.3861066  -0.2121718   0.18198705
  -0.04078794 -0.06734776 -0.38091075 -0.05797017]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:48:36,587 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_65/dense_195/kernel, shape=(8, 16), dtype=float32, value=[[ 0.35936034 -0.35557628 -0.34425426  0.15627193  0.25395036  0.4861418
  -0.3777609   0.29977584  0.263376   -0.44185686 -0.02886856  0.18214524
   0.2728765   0.15910864  0.333426    0.4531144 ]
 [ 0.23644423  0.03811896  0.23325431  0.29200447 -0.43566537 -0.4820249
   0.48147917  0.28891957  0.2752409  -0.01170421 -0.35521352  0.10564983
   0.14779401  0.1335845  -0.3005401   0.278677  ]
 [-0.14328086  0.09070969 -0.15907383 -0.47367883  0.38999307  0.44525564
   0.12562227  0.11941528  0.2960074  -0.41728163 -0.15004778 -0.49305785
  -0.1606462  -0.04236662 -0.45392382  0.06183386]
 [ 0.08300531  0.1608752   0.46820426  0.1922183   0.4089781  -0.41120744
  -0.3029548  -0.27739656  0.4888562  -0.03937018  0.22600865 -0.22843027
  -0.14404893  0.4097607   0.11375034 -0.48008037]
 [-0.28013992  0.2736659   0.33548033 -0.16986847  0.07537436  0.22653484
   0.32657695 -0.17741191 -0.4470024  -0.21934032  0.2977295   0.35579848
  -0.23269808  0.40518188  0.14422464 -0.22517323]
 [ 0.12787437 -0.34965754 -0.07784939  0.4136969   0.4838555   0.12634194
   0.38625705 -0.17591667 -0.48070538  0.27606165  0.392187   -0.49717736
   0.45301342 -0.32596838 -0.35185432  0.27336752]
 [-0.4498173   0.49290645  0.30127144 -0.3849275   0.0012219   0.20855772
   0.14327168  0.3420092   0.08186126 -0.06936908  0.24397182  0.23134899
  -0.23327053  0.44918573  0.18220544  0.00287271]
 [ 0.12959802 -0.10658205  0.12562215 -0.07332659 -0.04671144  0.17803776
   0.04826331 -0.21147501  0.34219158 -0.3861066  -0.2121718   0.18198705
  -0.04078794 -0.06734776 -0.38091075 -0.05797017]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:48:36,587 - __main__ - WARNING - Failed to train model for Sports & Leisure
2025-04-06 15:48:36,587 - __main__ - INFO - Processing industry 23/34: Materials
2025-04-06 15:48:36,589 - __main__ - INFO - Found 29 stocks in Materials industry
2025-04-06 15:48:37,345 - __main__ - INFO - Saved 494 records for Materials to industry_data_from_db\materials_training.csv
2025-04-06 15:48:37,864 - __main__ - INFO - Training model for Materials with 494 records
2025-04-06 15:48:37,864 - __main__ - INFO - Training model for Materials with 494 records
2025-04-06 15:48:37,864 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:48:37,865 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:48:37,894 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:48:37,895 - __main__ - INFO - Training fold 1/5
2025-04-06 15:48:49,182 - __main__ - INFO - Training fold 2/5
2025-04-06 15:48:49,232 - __main__ - ERROR - Error training model for Materials: Unknown variable: <Variable path=sequential_68/dense_204/kernel, shape=(8, 16), dtype=float32, value=[[ 0.23991299 -0.13245475  0.14561737  0.23991299  0.2248267   0.2266897
  -0.07313251 -0.09287059 -0.3949628  -0.09121823  0.43493187 -0.0080322
   0.05844128 -0.35743642  0.24054551 -0.0179776 ]
 [-0.2793938  -0.10440993 -0.22586608  0.0466125   0.03306258 -0.31526327
   0.08489132 -0.19743955 -0.14061737 -0.31982553  0.3478707  -0.31429482
  -0.07871544 -0.35870576  0.21191335  0.14479959]
 [-0.49606454 -0.35309505 -0.32720327  0.47753632  0.17137837 -0.46563864
  -0.38508177 -0.16189253  0.40959883  0.08529341  0.00547147  0.2953763
   0.37883735  0.1630584  -0.44295728  0.25564933]
 [ 0.15552378  0.2745149   0.30198908 -0.07815564  0.0243541  -0.19556475
   0.36454523  0.12133372  0.33361578  0.290509    0.12493551 -0.27179956
   0.25128162  0.27437854  0.44414568  0.18807912]
 [ 0.07539749 -0.41222548 -0.3871945   0.0920434  -0.21064389 -0.39227843
   0.41755044 -0.38302565  0.24975884  0.37589657 -0.16802335 -0.19332945
   0.08511937  0.39304447 -0.34219897 -0.24396646]
 [ 0.35753906 -0.34216237 -0.04941058 -0.48265338  0.09036505  0.12006307
   0.00929797 -0.06578851 -0.38621473 -0.4667921   0.04413486  0.02690232
  -0.39189422  0.01523852  0.44633365 -0.0239197 ]
 [-0.01856804 -0.30751002 -0.10773182 -0.33936775  0.22295284  0.3184166
   0.47080827 -0.07450664  0.04382885  0.26031327  0.16388452 -0.12465358
   0.46748567  0.05310476 -0.21944559 -0.07728589]
 [ 0.13701987  0.1763643  -0.00561416 -0.37576282  0.4209199  -0.39261794
   0.4375267   0.13454926 -0.13793123 -0.43625343 -0.33384764 -0.2879746
  -0.3780743  -0.06504667  0.37069702  0.37106395]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:48:49,232 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_68/dense_204/kernel, shape=(8, 16), dtype=float32, value=[[ 0.23991299 -0.13245475  0.14561737  0.23991299  0.2248267   0.2266897
  -0.07313251 -0.09287059 -0.3949628  -0.09121823  0.43493187 -0.0080322
   0.05844128 -0.35743642  0.24054551 -0.0179776 ]
 [-0.2793938  -0.10440993 -0.22586608  0.0466125   0.03306258 -0.31526327
   0.08489132 -0.19743955 -0.14061737 -0.31982553  0.3478707  -0.31429482
  -0.07871544 -0.35870576  0.21191335  0.14479959]
 [-0.49606454 -0.35309505 -0.32720327  0.47753632  0.17137837 -0.46563864
  -0.38508177 -0.16189253  0.40959883  0.08529341  0.00547147  0.2953763
   0.37883735  0.1630584  -0.44295728  0.25564933]
 [ 0.15552378  0.2745149   0.30198908 -0.07815564  0.0243541  -0.19556475
   0.36454523  0.12133372  0.33361578  0.290509    0.12493551 -0.27179956
   0.25128162  0.27437854  0.44414568  0.18807912]
 [ 0.07539749 -0.41222548 -0.3871945   0.0920434  -0.21064389 -0.39227843
   0.41755044 -0.38302565  0.24975884  0.37589657 -0.16802335 -0.19332945
   0.08511937  0.39304447 -0.34219897 -0.24396646]
 [ 0.35753906 -0.34216237 -0.04941058 -0.48265338  0.09036505  0.12006307
   0.00929797 -0.06578851 -0.38621473 -0.4667921   0.04413486  0.02690232
  -0.39189422  0.01523852  0.44633365 -0.0239197 ]
 [-0.01856804 -0.30751002 -0.10773182 -0.33936775  0.22295284  0.3184166
   0.47080827 -0.07450664  0.04382885  0.26031327  0.16388452 -0.12465358
   0.46748567  0.05310476 -0.21944559 -0.07728589]
 [ 0.13701987  0.1763643  -0.00561416 -0.37576282  0.4209199  -0.39261794
   0.4375267   0.13454926 -0.13793123 -0.43625343 -0.33384764 -0.2879746
  -0.3780743  -0.06504667  0.37069702  0.37106395]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:48:49,233 - __main__ - WARNING - Failed to train model for Materials
2025-04-06 15:48:49,233 - __main__ - INFO - Processing industry 24/34: Cloud Computing
2025-04-06 15:48:49,234 - __main__ - INFO - Found 23 stocks in Cloud Computing industry
2025-04-06 15:48:49,505 - __main__ - INFO - Saved 166 records for Cloud Computing to industry_data_from_db\cloud_computing_training.csv
2025-04-06 15:48:50,188 - __main__ - INFO - Training model for Cloud Computing with 166 records
2025-04-06 15:48:50,188 - __main__ - INFO - Training model for Cloud Computing with 166 records
2025-04-06 15:48:50,188 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:48:50,189 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:48:50,227 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:48:50,228 - __main__ - INFO - Training fold 1/5
2025-04-06 15:48:58,439 - __main__ - INFO - Training fold 2/5
2025-04-06 15:48:58,495 - __main__ - ERROR - Error training model for Cloud Computing: Unknown variable: <Variable path=sequential_71/dense_213/kernel, shape=(8, 16), dtype=float32, value=[[ 0.2025187  -0.48442638 -0.366408    0.44645822 -0.14795518 -0.36929476
   0.33110428 -0.26561594  0.17899966  0.18370211  0.23689198 -0.41957617
   0.18643963  0.11095643  0.47750378  0.00341713]
 [-0.3389418  -0.16018355 -0.38157356 -0.38974905  0.47555125 -0.47208846
   0.18045306 -0.44677567  0.02579498 -0.34429026 -0.06557894  0.18006766
  -0.4991294  -0.35484052  0.24875867 -0.3910483 ]
 [ 0.0995115   0.14445162 -0.11274147 -0.16662943  0.26930702 -0.01599324
  -0.2210275   0.40855777  0.12722623  0.01201785  0.18072307 -0.38243484
   0.32149565  0.16614115  0.41082454 -0.49111497]
 [-0.1940645   0.1644584   0.36206114 -0.03847837  0.20342672 -0.32140303
  -0.3754673   0.29348147  0.14963078  0.16563714 -0.48909938  0.02235901
  -0.10770035 -0.35107756 -0.44591594 -0.49508548]
 [ 0.1464876  -0.17800438  0.15686285 -0.01839077  0.10026109 -0.30044317
   0.33202887  0.3198576   0.07859123  0.18878853  0.35176682  0.20112479
  -0.15103734 -0.3825438   0.08833706 -0.21754587]
 [ 0.3179791   0.35565567  0.45020998 -0.12723291  0.44783628  0.43066895
   0.07263458 -0.23902321  0.15056348 -0.23957813 -0.37824607 -0.00520444
   0.47680748  0.1093657  -0.28701591  0.2725141 ]
 [ 0.03945982  0.33924317  0.12242496 -0.40394878  0.37016416  0.14319813
   0.2759434  -0.08987725 -0.09086382 -0.19350517 -0.47402906 -0.37204397
   0.312881   -0.2033602   0.43570328 -0.16508389]
 [ 0.02854824  0.12608552  0.15573967 -0.29159713  0.45072353  0.40684426
   0.41505492 -0.19575572 -0.08240342  0.33427203  0.18337214 -0.4768939
  -0.37665427  0.25204504 -0.14741337  0.15571189]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.
2025-04-06 15:48:58,495 - __main__ - ERROR - Traceback (most recent call last):
  File "c:\Users\shawn\OneDrive\文件\GitHub\Finance_stuff\db_train_fixed.py", line 626, in train_industry_model
    fold_history = fold_model.fit(
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\utils\traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\shawn\AppData\Local\Programs\Python\Python310\lib\site-packages\keras\src\optimizers\base_optimizer.py", line 329, in _check_variables_are_known
    raise ValueError(
ValueError: Unknown variable: <Variable path=sequential_71/dense_213/kernel, shape=(8, 16), dtype=float32, value=[[ 0.2025187  -0.48442638 -0.366408    0.44645822 -0.14795518 -0.36929476
   0.33110428 -0.26561594  0.17899966  0.18370211  0.23689198 -0.41957617
   0.18643963  0.11095643  0.47750378  0.00341713]
 [-0.3389418  -0.16018355 -0.38157356 -0.38974905  0.47555125 -0.47208846
   0.18045306 -0.44677567  0.02579498 -0.34429026 -0.06557894  0.18006766
  -0.4991294  -0.35484052  0.24875867 -0.3910483 ]
 [ 0.0995115   0.14445162 -0.11274147 -0.16662943  0.26930702 -0.01599324
  -0.2210275   0.40855777  0.12722623  0.01201785  0.18072307 -0.38243484
   0.32149565  0.16614115  0.41082454 -0.49111497]
 [-0.1940645   0.1644584   0.36206114 -0.03847837  0.20342672 -0.32140303
  -0.3754673   0.29348147  0.14963078  0.16563714 -0.48909938  0.02235901
  -0.10770035 -0.35107756 -0.44591594 -0.49508548]
 [ 0.1464876  -0.17800438  0.15686285 -0.01839077  0.10026109 -0.30044317
   0.33202887  0.3198576   0.07859123  0.18878853  0.35176682  0.20112479
  -0.15103734 -0.3825438   0.08833706 -0.21754587]
 [ 0.3179791   0.35565567  0.45020998 -0.12723291  0.44783628  0.43066895
   0.07263458 -0.23902321  0.15056348 -0.23957813 -0.37824607 -0.00520444
   0.47680748  0.1093657  -0.28701591  0.2725141 ]
 [ 0.03945982  0.33924317  0.12242496 -0.40394878  0.37016416  0.14319813
   0.2759434  -0.08987725 -0.09086382 -0.19350517 -0.47402906 -0.37204397
   0.312881   -0.2033602   0.43570328 -0.16508389]
 [ 0.02854824  0.12608552  0.15573967 -0.29159713  0.45072353  0.40684426
   0.41505492 -0.19575572 -0.08240342  0.33427203  0.18337214 -0.4768939
  -0.37665427  0.25204504 -0.14741337  0.15571189]]>. This optimizer can only be called for the variables it was originally built with. When working with a new set of variables, you should recreate a new optimizer instance.

2025-04-06 15:48:58,495 - __main__ - WARNING - Failed to train model for Cloud Computing
2025-04-06 15:48:58,495 - __main__ - INFO - Processing industry 25/34: Chemicals
2025-04-06 15:48:58,497 - __main__ - INFO - Found 23 stocks in Chemicals industry
2025-04-06 15:48:59,066 - __main__ - INFO - Saved 305 records for Chemicals to industry_data_from_db\chemicals_training.csv
2025-04-06 15:48:59,690 - __main__ - INFO - Training model for Chemicals with 305 records
2025-04-06 15:48:59,690 - __main__ - INFO - Training model for Chemicals with 305 records
2025-04-06 15:48:59,690 - __main__ - INFO - Using features: ['revenue', 'operating_margin', 'historical_growth_mean', 'debt_to_equity', 'equity_to_assets', 'gross_margin', 'current_ratio', 'revenue_growth']
2025-04-06 15:48:59,691 - __main__ - INFO - Using future_6m_return as target variable
2025-04-06 15:48:59,720 - __main__ - INFO - Using 5-fold cross-validation
2025-04-06 15:48:59,721 - __main__ - INFO - Training fold 1/5
